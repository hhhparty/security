# Windows入侵排查

基本思路：
- 确定目标
- 取样
- 分析
- 记录
- 上报
- 处置

## 确定目标

从资产风险等级、资产重要性、攻击意图和手法考虑，筛查资产，建议检查的资产范围为：
- 曾经被入侵的资产（检查历史报告，确认是否修复过已利用过的漏洞）
- 互联网暴漏的资产
- 安装了高危漏洞频繁的组件或应用（如weblogic、jboss、fastjson、shiro、struts2）的资产
- 关键资产，例如域控、DNS服务器等，查看IT系统拓扑和配置文档。

## 取样（入侵痕迹排查）

入侵痕迹排查，主要从下列方面：
- 网络连接，例如是否有后门发起向c2服务器连接；
- 进程信息，例如从异常进程定位恶意进程，再定位到恶意文件；
- 后门账号，例如为了维持持续控制，可能会添加后门账号
- 计划任务
- 登录日志
- 自启动项
- 文件（特别是异常文件）

## 分析
- 攻击者一般会使用```attrib 恶意程序名 +s +h```命令，修改文件属性，隐藏恶意程序。所以可以先设置“工具—文件夹选项—查看”。设置显示所有文件。
- 查看网络连接，通常用```netstat -ano```,80和443通常是可以放行的。若出现下列情况则为异常：
  - 若存在对内网网段大量主机的某些端口（如22，445，3389，6379） 或全端口发起网络连接尝试，这说明攻击者将此主机作为跳板，对内网进行扫描或口令破解。
  - 若存在和Internet 某ip地址的连接（Established 或 SYN_SENT 状态），且ip地址为国外或云主机，则重点关注。可以查看威胁情报查看是否已标记为恶意ip（例如：https://x.threatbook.cn/等等）
- 若无法直接从网络连接或IP地址查出问题，则可查看对应进程id，判断进程是否有异常。
- 若进程也无法看出异常，则查看对应文件，将文件上传至virustotal检测。
- 若任务管理器可以看到命令，但无法看到具体的命令行参数，那么使用 process explorer等工具来查看
- 查看攻击者大多会使用的目录
  - 各盘符下的临时目录，例如：c:\TEMP，c:\windows\temp
  - %APPDATA% 目录（在文件夹窗口地址栏输入%APPDATA%，回车即可打开当前用户的appdata目录），可以按照修改日期排序筛选出比较临近时间有变更的文件。
  - 浏览器下载目录
  - 用户最近文件%UserProfile%\Recent，如Administrator对应的目录为C:\Users\Administrator\Recent
  - 回收站
- 常见的后门文件，会在粘滞键exe（是按5下shift后，windows就执行了system32下的sethc.exe）、注册表中...留有痕迹.
  - 查看粘滞键exe，查看C:\Windows\System32\sethc.exe文件的创建、修改时间是否正常。sethc的创建时间与修改时间不同，可确定sethc已被替换成后门文件。由于攻击者可修改文件时间，上述简单粗暴的判断方式可能不靠谱，可将sethc拷贝出来、上传至VT检测危害。
  - 检查注册表“HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options”下所有exe项中是否有debugger键，若有debugger键(键值通常为指向某个恶意可执行文件)，将其键值对应的程序上传至VT检测。
- 查看后门账号，可以打开regedit查看注册表中的账号；查看administrators组中是否存在赋权异常账号
  - 查看注册表中HKLM\SAM\SAM\Domains\Account\Users\Names中是否有多余的账号（可询问客户运维人员以确定账号存在的必要性）。
  - 正常情况下，上述路径的SAM权限仅system用户可查看，需要给administrator用户授权才能打开完整路径。对SAM右键、给administator用户添加完全控制权限（下图的权限操作方法适用于win7及以上操作系统）：
  - 带有$符号的账号特指隐藏账号（如aaaa$），正常业务中不需要创建隐藏账号，可判断带有$符号的均为后门账号。然后在客户运维的协助下排查其他的异常账号。
  - 查看administrators组中是否存在赋权异常的账号。比如正常情况下guest用户处于禁用状态、普通应用账户(weblogic、apache、mysql)不需要在administrators组中。
    - 执行```net user```查看用户
    - 执行命令```net user guest```查看guest账号的信息，如果guest账号被启用，且在管理员组成员中有guest用户，需要询问客户运维人员该guest账户启用的必要性以及加入管理组是否有必要，否则可认为攻击者将系统自带用户guest启用并提权至管理员组后作为后门账号使用。
    - 执行```net localgroup Administrators```关注管理员组别是否存在异常账号；
  - 查看自启动项
    - 使用 systemninternal - Autoruns 工具进行详细查看启动项。排除不需要的启动项。
    - 查看组策略，无法使用工具时可以使用组策略```gpedit.msc```-计算机配置/用户配置-windows设置-脚本，再次可以设置服务器启动、管技或用户登录、注销时执行的脚本。

- 查看日志
  - 查看登录日志暴力破解痕迹
  - 查看日志中的账号的增加、修改痕迹
  - 查看远程桌面登录日志中的登录痕迹

## windows 日志分析

### 采集样本

Windows在默认状态下，也会记录一些简单的日志，日志默认大小 20M，在Windows上可以通过使用Win+R打开运行框，输入```eventvwr.msc```打开事件查看器，当使用默认的审核策略时，显示的日志内容仅仅是一些简单的内容，当修改审核策略之后，日志记录的内容会有所增加。

前提条件：
- Windows服务器系统的审核功能必须是启用的，并且配置好审计策略，这样才会有故障、安全等的系统日志文件。
  - 默认状态下并没有启用，设置方法：```开始 → 管理工具 → 本地安全策略 → 本地策略 → 审核策略```或使用```gpedit.msc```设置组策略中的windows设置-本地策略-审核策略。
- 日志需要提前做好定期备份，最好是全量异地备份。
- 做好日志文件的访问控制、限制权限，尽可能地降低日志被删除和被篡改风险。

满足以上条件，日志分析才有科学、真实、不可抵赖性。

### 日志类型
打开日志：开始-管理工具-事件查看器，一般查看三类日志：
- 应用程序日志
- 安全日志
- 系统日志

他们的格式为二进制XML的evtx文件。

#### 应用程序日志

包含由应用程序或系统程序记录的事件，主要记录程序运行方面的事件，默认存放路径：%SystemRoot%\System32\Winevt\Logs\Application.evtx。等保检查中的主机层面检查包含这一项。

#### 系统日志
记录操作系统组件产生的事件，主要包括驱动程序、系统组件和应用软件的崩溃以及数据丢失错误等。默认存放路径：%SystemRoot%\System32\Winevt\Logs\System.evtx
#### 安全日志

记录系统的安全审计事件，包含各种类型的登录日志、对象访问日志、进程追踪日志、特权使用、帐号管理、策略变更、系统事件。这个日志一般是安全工程师重点关注对象。默认存放路径：%SystemRoot%\System32\Winevt\Logs\Security.evtx

默认设置下，安全性日志是关闭的，管理员可以使用组策略来启动安全性日志，或者在注册表中设置审核策略，以便当安全性日志满后使系统停止响应。
#### 远程连接日志
应用程序和服务日志->Microsoft->Windows->-TerminalServices->RemoteConnectionManager->Operational

远程连接日志相关的重要事件 ID 和含义：
- 1149：用户认证成功
- 21：远程桌面服务：会话登录成功
- 24：远程桌面服务：会话已断开连接
- 25：远程桌面服务：会话重新连接成功
### 日志事件

#### 事件记录格式
事件ID字段
- Log Name：存储事件的事件日志的名称，在处理从同一系统提取的大量日志时很有用。
- Source：生成事件的服务，Microsoft组件或应用程序。
- Event ID：分配给每种已审计活动类型的代码。
- Level：分配给相关事件的严重性。
- User：在记录事件时，触发活动或源正在运行的用户上下文的用户帐户。注意，该字段通常表示“系统”而不是记录事件原因的用户
- OpCode：由生成日志的源分配
- Logged：记录事件的本地系统日期和时间
- Task Category：由生成日志的源分配
- keywords：用于对事件进行分组或排序。
- Computer：记录事件的计算机。当检查从多个系统收集的日志时，此功能很有用，但不应被视为导致事件的设备
- Description：一个文本块，其中记录了特定于所记录事件的其他信息，对于取证人员来说，这通常是最重要的字段。


#### 常用到的事件ID

对于Windows事件日志分析，不同的EVENT ID代表了不同的意义，下面是一下常用到的事件ID

事件ID	说明
1102	审核日志已清除
1104	安全日志现已满
4608	Windows正在启动
4609	Windows正在关闭
4616	系统时间已更改。
4625	帐户无法登录
4624	帐户已成功登录
4634	帐户已注销
4647	用户启动的注销
4672	使用超级用户（如管理员）进行登录
4720	创建用户
4657	注册表值已修改
4741	已创建计算机帐户
4742	计算机帐户已更改
4743	计算机帐户已删除


在打开事件查看器后，你可能会发现其中记录了很多发生的错误事件，但是在使用计算机的过程中并没有感知到，这是因为一些错误在后来的启动中进行了自我纠正。

#### 事件状态码


状态码	描述
0xC0000064	用户名不存在
0xC000006A	用户名正确但是密码错误
0xC0000234	用户被锁定
0xC0000072	账户被禁用
0xC000006F	用户尝试在他的星期几或一天中的时间限制之外登录
0xC0000070	工作站限制或违反身份验证策略的情况（在域控制器上查找事件ID 4820）
0xC0000193	帐户到期
0xC0000071	密码过期
0xC0000133	DC与其他计算机之间的时钟太不同步
0xC0000224	用户需要在下次登录时更改密码
0xC0000225	Windows发生错误，没有风险
0xc000015b	用户尚未在此计算机上被授予请求的登录类型（也称为登录权限）
根据表中的信息可以看到当前事件的状态码对应的是用户名正确但是密码错误

#### 关键事件
##### 登录事件
登录事件将在事件描述中包含类型代码。该代码的含义如下：

登录类型与描述：
- 2	交互式，例如在系统的键盘和屏幕上登录，或使用第三方远程访问工具（如VNC）进行远程登录。这种类型的登录将在会话期间将用户的凭据缓存在RAM中，并且可能将用户的凭据缓存在磁盘上。
- 3	网络（即从网络上的其他位置连接到此计算机上的共享文件夹）。这表示非交互式登录，它不会在RAM或磁盘上缓存用     户的凭据。
- 4	批处理（即计划任务）批处理登录类型由批处理服务器使用，其中进程可以代表用户执行而无需其直接干预
- 5	服务（服务由服务控制管理器启动）
- 7	解锁（即具有密码保护的屏幕）
- 8	NetworkCleartext用户从网络登录到此计算机。用户密码以未加密的形式传递到身份验证程序包。内置身份验证将所有哈希     凭据打包，然后再通过网络发送它们。凭据不会以纯文本（也称为明文）遍历网络。最常表示使用“基本身份验证”登录IIS。
- 9	NewCredentials（例如，具有RunAs或具有备用凭据的网络驱动器映射）。此登录类型似乎未在任何事件中显示。如果要     跟踪尝试使用备用凭据登录的用户，请查找事件ID 4648。
- 10	RemoteInteractive（终端服务，远程桌面或远程协助）。有关更多详细信息，请参见本节末尾的有关RDP的注释。
- 11	CachedInteractive（使用缓存的域凭据登录，例如在离开网络时登录到便携式计算机时）没有联系域控制器来验证凭据

在这里需要注意的是关于尝试登录系统的远程主机。据所涉及的系统，通过RDP失败的登录可能会记录为Type 3而不是Type 10。


### 日志分析

windows日志常见事件id：
- 4624— 成功登录
- 4625 —失败的登录
- 4634/4647 — 成功注销
- 4648— 使用显式(explicit)凭证登录(RunAs)
- 4672 — 用户使用超级用户权限的登录 (Administrator)
- 4720 — 账户创建

查看日志的重点内容如下：
- 查看登录日志中暴力破解痕迹；
  - 例如可以使用日志过滤器，筛选出4624和4625，需要留意日志中的SubjectUserNameIpAddress、IpAddress、IpPort、WorkstationName、TargetUserName。
  - 若是大量的失败登录，绝对可疑
  - 若大量为成功，且是内部人员，登录时间也是正常时间段，可以找到该人员核对一下，基本可以判断为正常事件。


- 查看账号管理日志中账号的新增、修改痕迹；
  - 查看4720、4722、4724、4738事件
  - 查看是否会创建后门账号、隐藏账号
- 查看远程桌面登录日志中的登录痕迹。  
  - 上面的3个日志很可能被覆盖掉，所以还需要再看远程登陆桌面的登录日志

#### 工具
windows日志分析工具：LogParser Lizard

#### 安全事件ID参考

EVENT_ID	           安全事件信息
1100	-----      事件记录服务已关闭
1101	-----      审计事件已被运输中断。
1102	-----      审核日志已清除
1104	-----      安全日志现已满
1105	-----      事件日志自动备份
1108	-----      事件日志记录服务遇到错误
4608	-----      Windows正在启动
4609	-----      Windows正在关闭
4610	-----      本地安全机构已加载身份验证包
4611	-----      已向本地安全机构注册了受信任的登录进程
4612	-----      为审计消息排队分配的内部资源已经用尽，导致一些审计丢失。
4614	-----      安全帐户管理器已加载通知包。
4615	-----      LPC端口使用无效
4616	-----      系统时间已更改。
4618	-----      已发生受监视的安全事件模式
4621	-----      管理员从CrashOnAuditFail恢复了系统
4622	-----      本地安全机构已加载安全包。
4624	-----      帐户已成功登录
4625	-----      帐户无法登录
4626	-----      用户/设备声明信息
4627	-----      集团会员信息。
4634	-----      帐户已注销
4646	-----      IKE DoS防护模式已启动
4647	-----      用户启动了注销
4648	-----      使用显式凭据尝试登录
4649	-----      检测到重播攻击
4650	-----      建立了IPsec主模式安全关联
4651	-----      建立了IPsec主模式安全关联
4652	-----      IPsec主模式协商失败
4653	-----      IPsec主模式协商失败
4654	-----      IPsec快速模式协商失败
4655	-----      IPsec主模式安全关联已结束
4656	-----      请求了对象的句柄
4657	-----      注册表值已修改
4658	-----      对象的句柄已关闭
4659	-----      请求删除对象的句柄
4660	-----      对象已删除
4661	-----      请求了对象的句柄
4662	-----      对对象执行了操作
4663	-----      尝试访问对象
4664	-----      试图创建一个硬链接
4665	-----      尝试创建应用程序客户端上下文。
4666	-----      应用程序尝试了一个操作
4667	-----      应用程序客户端上下文已删除
4668	-----      应用程序已初始化
4670	-----      对象的权限已更改
4671	-----      应用程序试图通过TBS访问被阻止的序号
4672	-----      分配给新登录的特权
4673	-----      特权服务被召唤
4674	-----      尝试对特权对象执行操作
4675	-----      SID被过滤掉了
4688	-----      已经创建了一个新流程
4689	-----      一个过程已经退出
4690	-----      尝试复制对象的句柄
4691	-----      请求间接访问对象
4692	-----      尝试备份数据保护主密钥
4693	-----      尝试恢复数据保护主密钥
4694	-----      试图保护可审计的受保护数据
4695	-----      尝试不受保护的可审计受保护数据
4696	-----      主要令牌已分配给进程
4697	-----      系统中安装了一项服务
4698	-----      已创建计划任务
4699	-----      计划任务已删除
4700	-----      已启用计划任务
4701	-----      计划任务已禁用
4702	-----      计划任务已更新
4703	-----      令牌权已经调整
4704	-----      已分配用户权限
4705	-----      用户权限已被删除
4706	-----      为域创建了新的信任
4707	-----      已删除对域的信任
4709	-----      IPsec服务已启动
4710	-----      IPsec服务已禁用
4711	-----      PAStore引擎（1％）
4712	-----      IPsec服务遇到了潜在的严重故障
4713	-----      Kerberos策略已更改
4714	-----      加密数据恢复策略已更改
4715	-----      对象的审核策略（SACL）已更改
4716	-----      可信域信息已被修改
4717	-----      系统安全访问权限已授予帐户
4718	-----      系统安全访问已从帐户中删除
4719	-----      系统审核策略已更改
4720	-----      已创建用户帐户
4722	-----      用户帐户已启用
4723	-----      尝试更改帐户的密码
4724	-----      尝试重置帐户密码
4725	-----      用户帐户已被禁用
4726	-----      用户帐户已删除
4727	-----      已创建启用安全性的全局组
4728	-----      已将成员添加到启用安全性的全局组中
4729	-----      成员已从启用安全性的全局组中删除
4730	-----      已删除启用安全性的全局组
4731	-----      已创建启用安全性的本地组
4732	-----      已将成员添加到启用安全性的本地组
4733	-----      成员已从启用安全性的本地组中删除
4734	-----      已删除已启用安全性的本地组
4735	-----      已启用安全性的本地组已更改
4737	-----      启用安全性的全局组已更改
4738	-----      用户帐户已更改
4739	-----      域策略已更改
4740	-----      用户帐户已被锁定
4741	-----      已创建计算机帐户
4742	-----      计算机帐户已更改
4743	-----      计算机帐户已删除
4744	-----      已创建禁用安全性的本地组
4745	-----      已禁用安全性的本地组已更改
4746	-----      已将成员添加到已禁用安全性的本地组
4747	-----      已从安全性已禁用的本地组中删除成员
4748	-----      已删除安全性已禁用的本地组
4749	-----      已创建一个禁用安全性的全局组
4750	-----      已禁用安全性的全局组已更改
4751	-----      已将成员添加到已禁用安全性的全局组中
4752	-----      成员已从禁用安全性的全局组中删除
4753	-----      已删除安全性已禁用的全局组
4754	-----      已创建启用安全性的通用组
4755	-----      启用安全性的通用组已更改
4756	-----      已将成员添加到启用安全性的通用组中
4757	-----      成员已从启用安全性的通用组中删除
4758	-----      已删除启用安全性的通用组
4759	-----      创建了一个安全禁用的通用组
4760	-----      安全性已禁用的通用组已更改
4761	-----      已将成员添加到已禁用安全性的通用组中
4762	-----      成员已从禁用安全性的通用组中删除
4763	-----      已删除安全性已禁用的通用组
4764	-----      组类型已更改
4765	-----      SID历史记录已添加到帐户中
4766	-----      尝试将SID历史记录添加到帐户失败
4767	-----      用户帐户已解锁
4768	-----      请求了Kerberos身份验证票证（TGT）
4769	-----      请求了Kerberos服务票证
4770	-----      更新了Kerberos服务票证
4771	-----      Kerberos预身份验证失败
4772	-----      Kerberos身份验证票证请求失败
4773	-----      Kerberos服务票证请求失败
4774	-----      已映射帐户以进行登录
4775	-----      无法映射帐户以进行登录
4776	-----      域控制器尝试验证帐户的凭据
4777	-----      域控制器无法验证帐户的凭据
4778	-----      会话重新连接到Window Station
4779	-----      会话已与Window   Station断开连接
4780	-----      ACL是在作为管理员组成员的帐户上设置的
4781	-----      帐户名称已更改
4782	-----      密码哈希帐户被访问
4783	-----      创建了一个基本应用程序组
4784	-----      基本应用程序组已更改
4785	-----      成员已添加到基本应用程序组
4786	-----      成员已从基本应用程序组中删除
4787	-----      非成员已添加到基本应用程序组
4788	-----      从基本应用程序组中删除了非成员。
4789	-----      基本应用程序组已删除
4790	-----      已创建LDAP查询组
4791	-----      基本应用程序组已更改
4792	-----      LDAP查询组已删除
4793	-----      密码策略检查API已被调用
4794	-----      尝试设置目录服务还原模式管理员密码
4797	-----      试图查询帐户是否存在空白密码
4798	-----      枚举了用户的本地组成员身份。
4799	-----      已枚举启用安全性的本地组成员身份
4800	-----      工作站已锁定
4801	-----      工作站已解锁
4802	-----      屏幕保护程序被调用
4803	-----      屏幕保护程序被解雇了
4816	-----      RPC在解密传入消息时检测到完整性违规
4817	-----      对象的审核设置已更改。
4818	-----      建议的中央访问策略不授予与当前中央访问策略相同的访问权限
4819	-----      计算机上的中央访问策略已更改
4820	-----      Kerberos票证授予票证（TGT）被拒绝，因为该设备不符合访问控制限制
4821	-----      Kerberos服务票证被拒绝，因为用户，设备或两者都不符合访问控制限制
4822	-----      NTLM身份验证失败，因为该帐户是受保护用户组的成员
4823	-----      NTLM身份验证失败，因为需要访问控制限制
4824	-----      使用DES或RC4进行Kerberos预身份验证失败，因为该帐户是受保护用户组的成员
4825	-----      用户被拒绝访问远程桌面。默认情况下，仅当用户是Remote
                   Desktop Users组或Administrators组的成员时才允许用户进行连接
4826	-----      加载引导配置数据
4830	-----      SID历史记录已从帐户中删除
4864	-----      检测到名称空间冲突
4865	-----      添加了受信任的林信息条目
4866	-----      已删除受信任的林信息条目
4867	-----      已修改受信任的林信息条目
4868	-----      证书管理器拒绝了挂起的证书请求
4869	-----      证书服务收到重新提交的证书请求
4870	-----      证书服务撤销了证书
4871	-----      证书服务收到发布证书吊销列表（CRL）的请求
4872	-----      证书服务发布证书吊销列表（CRL）
4873	-----      证书申请延期已更改
4874	-----      一个或多个证书请求属性已更改。
4875	-----      证书服务收到关闭请求
4876	-----      证书服务备份已启动
4877	-----      证书服务备份已完成
4878	-----      证书服务还原已开始
4879	-----      证书服务恢复已完成
4880	-----      证书服务已启动
4881	-----      证书服务已停止
4882	-----      证书服务的安全权限已更改
4883	-----      证书服务检索到存档密钥
4884	-----      证书服务将证书导入其数据库
4885	-----      证书服务的审核筛选器已更改
4886	-----      证书服务收到证书请求
4887	-----      证书服务批准了证书请求并颁发了证书
4888	-----      证书服务拒绝了证书请求
4889	-----      证书服务将证书请求的状态设置为挂起
4890	-----      证书服务的证书管理器设置已更改。
4891	-----      证书服务中的配置条目已更改
4892	-----      证书服务的属性已更改
4893	-----      证书服务存档密钥
4894	-----      证书服务导入并存档了一个密钥
4895	-----      证书服务将CA证书发布到Active Directory域服务
4896	-----      已从证书数据库中删除一行或多行
4897	-----      启用角色分离
4898	-----      证书服务加载了一个模板
4899	-----      证书服务模板已更新
4900	-----      证书服务模板安全性已更新
4902	-----      已创建每用户审核策略表
4904	-----      尝试注册安全事件源
4905	-----      尝试取消注册安全事件源
4906	-----      CrashOnAuditFail值已更改
4907	-----      对象的审核设置已更改
4908	-----      特殊组登录表已修改
4909	-----      TBS的本地策略设置已更改
4910	-----      TBS的组策略设置已更改
4911	-----      对象的资源属性已更改
4912	-----      每用户审核策略已更改
4913	-----      对象的中央访问策略已更改
4928	-----      建立了Active  Directory副本源命名上下文
4929	-----      已删除Active  Directory副本源命名上下文
4930	-----      已修改Active  Directory副本源命名上下文
4931	-----      已修改Active  Directory副本目标命名上下文
4932	-----      已开始同步Active  Directory命名上下文的副本
4933	-----      Active  Directory命名上下文的副本的同步已结束
4934	-----      已复制Active  Directory对象的属性
4935	-----      复制失败开始
4936	-----      复制失败结束
4937	-----      从副本中删除了一个延迟对象
4944	-----      Windows防火墙启动时，以下策略处于活动状态
4945	-----      Windows防火墙启动时列出了规则
4946	-----      已对Windows防火墙例外列表进行了更改。增加了一条规则
4947	-----      已对Windows防火墙例外列表进行了更改。规则被修改了
4948	-----      已对Windows防火墙例外列表进行了更改。规则已删除
4949	-----      Windows防火墙设置已恢复为默认值
4950	-----      Windows防火墙设置已更改
4951	-----      规则已被忽略，因为Windows防火墙无法识别其主要版本号
4952	-----      已忽略规则的某些部分，因为Windows防火墙无法识别其次要版本号
4953	-----      Windows防火墙已忽略规则，因为它无法解析规则
4954	-----      Windows防火墙组策略设置已更改。已应用新设置
4956	-----      Windows防火墙已更改活动配置文件
4957	-----      Windows防火墙未应用以下规则
4958	-----      Windows防火墙未应用以下规则，因为该规则引用了此计算机上未配置的项目
4960	-----      IPsec丢弃了未通过完整性检查的入站数据包
4961	-----      IPsec丢弃了重放检查失败的入站数据包
4962	-----      IPsec丢弃了重放检查失败的入站数据包
4963	-----      IPsec丢弃了应该受到保护的入站明文数据包
4964	-----      特殊组已分配给新登录
4965	-----      IPsec从远程计算机收到一个包含不正确的安全参数索引（SPI）的数据包。
4976	-----      在主模式协商期间，IPsec收到无效的协商数据包。
4977	-----      在快速模式协商期间，IPsec收到无效的协商数据包。
4978	-----      在扩展模式协商期间，IPsec收到无效的协商数据包。
4979	-----      建立了IPsec主模式和扩展模式安全关联。
4980	-----      建立了IPsec主模式和扩展模式安全关联
4981	-----      建立了IPsec主模式和扩展模式安全关联
4982	-----      建立了IPsec主模式和扩展模式安全关联
4983	-----      IPsec扩展模式协商失败
4984	-----      IPsec扩展模式协商失败
4985	-----      交易状态已发生变化
5024	-----      Windows防火墙服务已成功启动
5025	-----      Windows防火墙服务已停止
5027	-----      Windows防火墙服务无法从本地存储中检索安全策略
5028	-----      Windows防火墙服务无法解析新的安全策略。
5029	-----      Windows防火墙服务无法初始化驱动程序
5030	-----      Windows防火墙服务无法启动
5031	-----      Windows防火墙服务阻止应用程序接受网络上的传入连接。
5032	-----      Windows防火墙无法通知用户它阻止应用程序接受网络上的传入连接
5033	-----      Windows防火墙驱动程序已成功启动
5034	-----      Windows防火墙驱动程序已停止
5035	-----      Windows防火墙驱动程序无法启动
5037	-----      Windows防火墙驱动程序检测到严重的运行时错 终止
5038	-----      代码完整性确定文件的图像哈希无效
5039	-----      注册表项已虚拟化。
5040	-----      已对IPsec设置进行了更改。添加了身份验证集。
5041	-----      已对IPsec设置进行了更改。身份验证集已修改
5042	-----      已对IPsec设置进行了更改。身份验证集已删除
5043	-----      已对IPsec设置进行了更改。添加了连接安全规则
5044	-----      已对IPsec设置进行了更改。连接安全规则已修改
5045	-----      已对IPsec设置进行了更改。连接安全规则已删除
5046	-----      已对IPsec设置进行了更改。添加了加密集
5047	-----      已对IPsec设置进行了更改。加密集已被修改
5048	-----      已对IPsec设置进行了更改。加密集已删除
5049	-----      IPsec安全关联已删除
5050	-----      尝试使用对INetFwProfile.FirewallEnabled的调用以编程方式禁用Windows防火墙（FALSE
5051	-----      文件已虚拟化
5056	-----      进行了密码自检
5057	-----      加密原语操作失败
5058	-----      密钥文件操作
5059	-----      密钥迁移操作
5060	-----      验证操作失败
5061	-----      加密操作
5062	-----      进行了内核模式加密自检
5063	-----      尝试了加密提供程序操作
5064	-----      尝试了加密上下文操作
5065	-----      尝试了加密上下文修改
5066	-----      尝试了加密功能操作
5067	-----      尝试了加密功能修改
5068	-----      尝试了加密函数提供程序操作
5069	-----      尝试了加密函数属性操作
5070	-----      尝试了加密函数属性操作
5071	-----      Microsoft密钥分发服务拒绝密钥访问
5120	-----      OCSP响应程序服务已启动
5121	-----      OCSP响应程序服务已停止
5122	-----      OCSP响应程序服务中的配置条目已更改
5123	-----      OCSP响应程序服务中的配置条目已更改
5124	-----      在OCSP  Responder Service上更新了安全设置
5125	-----      请求已提交给OCSP  Responder Service
5126	-----      签名证书由OCSP  Responder Service自动更新
5127	-----      OCSP吊销提供商成功更新了吊销信息
5136	-----      目录服务对象已修改
5137	-----      已创建目录服务对象
5138	-----      目录服务对象已取消删除
5139	-----      已移动目录服务对象
5140	-----      访问了网络共享对象
5141	-----      目录服务对象已删除
5142	-----      添加了网络共享对象。
5143	-----      网络共享对象已被修改
5144	-----      网络共享对象已删除。
5145	-----      检查网络共享对象以查看是否可以向客户端授予所需的访问权限
5146	-----      Windows筛选平台已阻止数据包
5147	-----      限制性更强的Windows筛选平台筛选器阻止了数据包
5148	-----      Windows过滤平台检测到DoS攻击并进入防御模式; 与此攻击相关的数据包将被丢弃。
5149	-----      DoS攻击已经消退，正常处理正在恢复。
5150	-----      Windows筛选平台已阻止数据包。
5151	-----      限制性更强的Windows筛选平台筛选器阻止了数据包。
5152	-----      Windows筛选平台阻止了数据包
5153	-----      限制性更强的Windows筛选平台筛选器阻止了数据包
5154	-----      Windows过滤平台允许应用程序或服务在端口上侦听传入连接
5155	-----      Windows筛选平台已阻止应用程序或服务侦听端口上的传入连接
5156	-----      Windows筛选平台允许连接
5157	-----      Windows筛选平台已阻止连接
5158	-----      Windows筛选平台允许绑定到本地端口
5159	-----      Windows筛选平台已阻止绑定到本地端口
5168	-----      SMB  / SMB2的Spn检查失败。
5169	-----      目录服务对象已修改
5170	-----      在后台清理任务期间修改了目录服务对象
5376	-----      已备份凭据管理器凭据
5377	-----      Credential  Manager凭据已从备份还原
5378	-----      策略不允许请求的凭据委派
5440	-----      Windows筛选平台基本筛选引擎启动时出现以下callout
5441	-----      Windows筛选平台基本筛选引擎启动时存在以下筛选器
5442	-----      Windows筛选平台基本筛选引擎启动时，存在以下提供程序
5443	-----      Windows筛选平台基本筛选引擎启动时，存在以下提供程序上下文
5444	-----      Windows筛选平台基本筛选引擎启动时，存在以下子层
5446	-----      Windows筛选平台标注已更改
5447	-----      Windows筛选平台筛选器已更改
5448	-----      Windows筛选平台提供程序已更改
5449	-----      Windows筛选平台提供程序上下文已更改
5450	-----      Windows筛选平台子层已更改
5451	-----      建立了IPsec快速模式安全关联
5452	-----      IPsec快速模式安全关联已结束
5453	-----      与远程计算机的IPsec协商失败，因为未启动IKE和AuthIP  IPsec密钥模块（IKEEXT）服务
5456	-----      PAStore引擎在计算机上应用了Active  Directory存储IPsec策略
5457	-----      PAStore引擎无法在计算机上应用Active  Directory存储IPsec策略
5458	-----      PAStore引擎在计算机上应用了Active  Directory存储IPsec策略的本地缓存副本
5459	-----      PAStore引擎无法在计算机上应用Active  Directory存储IPsec策略的本地缓存副本
5460	-----      PAStore引擎在计算机上应用了本地注册表存储IPsec策略
5461	-----      PAStore引擎无法在计算机上应用本地注册表存储IPsec策略
5462	-----      PAStore引擎无法在计算机上应用某些活动IPsec策略规则
5463	-----      PAStore引擎轮询活动IPsec策略的更改并检测不到任何更改
5464	-----      PAStore引擎轮询活动IPsec策略的更改，检测到更改并将其应用于IPsec服务
5465	-----      PAStore Engine收到强制重新加载IPsec策略的控件并成功处理控件
5466	-----      PAStore引擎轮询Active  Directory IPsec策略的更改，确定无法访问Active Directory，并将使用Active Directory
IPsec策略的缓存副本
5467	-----      PAStore引擎轮询Active Directory IPsec策略的更改，确定可以访问Active Directory，并且未找到对策略的更改
5468	-----      PAStore引擎轮询Active Directory IPsec策略的更改，确定可以访问Active Directory，找到策略更改并应用这些更改
5471	-----      PAStore引擎在计算机上加载了本地存储IPsec策略
5472	-----      PAStore引擎无法在计算机上加载本地存储IPsec策略
5473	-----      PAStore引擎在计算机上加载了目录存储IPsec策略
5474	-----      PAStore引擎无法在计算机上加载目录存储IPsec策略
5477	-----      PAStore引擎无法添加快速模式过滤器
5478	-----      IPsec服务已成功启动
5479	-----      IPsec服务已成功关闭
5480	-----      IPsec服务无法获取计算机上的完整网络接口列表
5483	-----      IPsec服务无法初始化RPC服务器。无法启动IPsec服务
5484	-----      IPsec服务遇到严重故障并已关闭
5485	-----      IPsec服务无法在网络接口的即插即用事件上处理某些IPsec筛选器
5632	-----      已请求对无线网络进行身份验证
5633	-----      已请求对有线网络进行身份验证
5712	-----      尝试了远程过程调用（RPC）
5888	-----      COM +目录中的对象已被修改
5889	-----      从COM +目录中删除了一个对象
5890	-----      一个对象已添加到COM +目录中
6144	-----      组策略对象中的安全策略已成功应用
6145	-----      处理组策略对象中的安全策略时发生一个或多个错误
6272	-----      网络策略服务器授予用户访问权限
6273	-----      网络策略服务器拒绝访问用户
6274	-----      网络策略服务器放弃了对用户的请求
6275	-----      网络策略服务器放弃了用户的记帐请求
6276	-----      网络策略服务器隔离了用户
6277	-----      网络策略服务器授予用户访问权限，但由于主机未满足定义的健康策略而将其置于试用期
6278	-----      网络策略服务器授予用户完全访问权限，因为主机符合定义的健康策略
6279	-----      由于重复失败的身份验证尝试，网络策略服务器锁定了用户帐户
6280	-----      网络策略服务器解锁了用户帐户
6281	-----      代码完整性确定图像文件的页面哈希值无效...
6400	-----      BranchCache：在发现内容可用性时收到格式错误的响应。
6401	-----      BranchCache：从对等方收到无效数据。数据被丢弃。
6402	-----      BranchCache：提供数据的托管缓存的消息格式不正确。
6403	-----      BranchCache：托管缓存发送了对客户端消息的错误格式化响应以提供数据。
6404	-----      BranchCache：无法使用配置的SSL证书对托管缓存进行身份验证。
6405	-----      BranchCache：发生了事件ID％1的％2个实例。
6406	-----      ％1注册到Windows防火墙以控制以下过滤：
6408	-----      已注册的产品％1失败，Windows防火墙现在正在控制％2的过滤。
6409	-----      BranchCache：无法解析服务连接点对象
6410	-----      代码完整性确定文件不满足加载到进程中的安全性要求。这可能是由于使用共享部分或其他问题
6416	-----      系统识别出新的外部设备。
6417	-----      FIPS模式加密自检成功
6418	-----      FIPS模式加密自检失败
6419	-----      发出了禁用设备的请求
6420	-----      设备已禁用
6421	-----      已发出请求以启用设备
6422	-----      设备已启用
6423	-----      系统策略禁止安装此设备
6424	-----      在事先被政策禁止之后，允许安装此设备
8191	-----      最高系统定义的审计消息值