# 实验x1 识别汇编代码中的C代码结构

## 实验内容

1.分析lab06-01.exe中的恶意代码

## 实验步骤

一.分析lab06-01.exe中的恶意代码

1.由main函数调用的唯一子过程中发现的主要代码结构是什么？

> 提示：main调用的唯一子过程是 sub_401000 。这个子过程用于判断当前连接互联网状态，是一个if-else结构。根据MSDN，当存在一个可用的Internet连接时，InternetGetConnectedState函数返1，否则返回0。因此，如果结果是1,零标志位ZF会被清除，jz指令会进入错误分支:否则，进入正确分支。该函数中使用的代码结构是if语句。

2.位于0x40105F的子过程是什么？

>提示：直接方法是看该过程的细节，但这将使人陷入迷惑；另一种思路是看调用这个过程之前的压栈指令，容易看出每次压的都是字符串，所以可以猜测该过程是printf函数。

3.这个程序的功能是什么？

>主要是判断是否连接着互联网。


二.分析lab06-02.exe

1.main函数调用的第一个子过程执行了什么操作？

>提示：与上题一样，仍然是判断是否连接互联网的一个if-else判断。

2.位于0x40117F位置的子过程是做什么的？

>提示：printf

3.main函数调用的第二个函数是做什么的？

>调用的第二个是sub_401040，它根据联网状态尝试打开explorer，打开www.practicalmalwareanalysis.com/cc.htm页面，并解析这个文件中的注释。