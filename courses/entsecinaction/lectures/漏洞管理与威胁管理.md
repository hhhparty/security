# 漏洞管理与威胁管理

## 定义

### 威胁管理

收集、处理和利用组织面临的威胁知识，在威胁完全实现之前，主动改进保护、检测和响应控制。

"Threat Management: Collecting, processing, and using knowledge of threats
facing the organization to proactively improve protect, detect, and respond
controls before threats are fully realized."

威胁管理与漏洞管理有区别，漏洞管理聚焦于缓解已知漏洞，它主要通过修补和更新控制措施。


威胁管理中的5个活动：一个威胁管理过程包含了3个核心和两个额外的活动。
A threat management program consists of three core and two additional activities (figure 1).

- 威胁情报：收集和合并威胁情报，以获取更深层关于对手方法和意图的知识；这技术和战术情报，并且从多个威胁规则中提取。
  - 情报来源包括第三方IOC（indicator of comprise）,信息分享与分析中心（ISACs），新闻源，政府机构，别的合作部门（如法务、HR、物理安全、PR）。
- 威胁建模：使用漏洞、敌手、业务知识，在威胁真实发生前来理解一个威胁如何影响组织。
  - 常见的威胁建模方法论包括微软的STRIDE 威胁模型何DREAD 风险等级模型，Lockheed Martin's IDDIL-ATC方法论和[别的方法](https://owasp.org/www-community/Application_Threat_Modeling)。
- 安全分析：获取、存储、关联大量、多样数据集来获取洞见，来帮助实现安全和业务目标。
  - 例如安全分析可以检测缺少签名的攻击，基于可以活动、防止客户欺诈、通过查询历史数据调查当前事件范围。
- 捕获：致力于使用威胁模型和技术专业知识开发和验证新的检测逻辑并使用分析和自动化扩展这些工作的安全人员。
- 活动跟踪（campaign tracking）：调查过去的攻击和威胁情报，以充分确定、连接和跟踪攻击者针对组织的活动；这些努力可以揭示攻击者的身份、地点、动机、方法和目标。


<image src="images/威胁管理/威胁管理关键过程.png" alt="漏洞管理关键过程">

### 漏洞管理
业界态势：
- 传统漏洞管理方法执行的是渐进式风险降低操作。
  - 他们的修复重点，要么放在高CVSS的严重漏洞上（所谓以漏洞为中心的模式）；
  - 要么根据资产的价值和暴露面来定（比如面向互联网、第三方访问、含有敏感数据、提供业务关键功能等等；所谓资产为中心的模式）。
  - 然而，不幸的是，两种模式往往都落入以最少的补丁封堵最多风险的境地。

- 这些传统方法再也不能满足当今威胁态势的需求。
  - Gartner表示，公司企业应将其漏洞管理操作转向以威胁为中心的模式，实现临近威胁清除，而不是逐步的风险减小。
  - 即将到来的威胁可通过关联漏洞与其流行率加以识别：漏洞被恶意软件、勒索软件或漏洞利用工具包盯上了吗？
  - 有攻击者利用该漏洞针对我们的同行公司吗？
  - 该新模式下，临近威胁的缓解优先级会被拉高。虽然不能预测谁会攻击我们，但至少可以预估谁或什么东西有可能成功实施攻击。
  - 最后，计划“升级”已有漏洞及补丁管理操作的公司企业，应跳出自身当前安全态势的局限，以新兴安全分析和网络风险管理功能来增强工具集，构筑基于场景和目标的方法，评估“可能的”威胁，预计潜在威胁的影响和后果。

传统的漏洞管理让企业漏洞百出，但企业仍毫无察觉。
- tenable公司调查结果显示，2020年漏洞新披露数量较2016年增长了250%；91%的企业过去两年内至少经历过一次破坏性的网络攻击；60%的企业在过去两年内经历过两次或以上的破坏性网络攻击。

2021年tenable认为传统的漏洞管理无法保护企业的现代攻击面，原因是：
- 无法评估现代攻击面中变化最快的领域：云、OT、容器。
- CVSS得分会产生大量严重程度为“严重”和“高危”的漏洞，令企业窒碍难行
- 只能满足最低合规要求
- 漏洞数据的静态时间点视图，不能反映问题严重程度
- 59%的受访对象没有固定的计划标，或在漏洞公开披露后也不扫描漏洞
- 61%的用户表示首要任务使提升自身能力，以识破攻击者的伪装和潜入
- 仅38%的用于认为他们衡量网络安全风险业务成本的方法非常准确
- 44%的用户存在风险的漏洞因为CVSS得分低于7.0而被忽略


为何基于风险的漏洞管理？
- 51%的企业表示，他们的安全团队用于处理人工流程的时间大大超过应对漏洞的时间，导致漏洞处理工作严重积压。
  - 基于风险的漏洞管理，有助于了解每个漏洞的完整上下文，以最少的工作量最大限度减少风险；
  - 对整个攻击面商的所有漏洞提供清晰可见性；
  - 为做出最佳决策提供必要的深入洞见，通过强大的报告有效沟通团队效率。

为什么传统的漏洞管理会失效？原因有：
- 缺乏上下文。传统漏洞管理依赖于CVSS评分，只能反映理论角度风险。这些分值分配的过早，难以解决实际的漏洞利用，即使在威胁形势发生变化时CVSS的分值仍保持不变。
- 被动且缺乏专注度。基于CVSS的优先级分析会返回过多漏洞，根本无法快速解决。这让安全团队不得不一直扮演救火队员的角色，只能对夺人眼球的最新漏洞做出反应，忽略了其它可能构成更大直接风险的漏洞。
- 不完整的可见性。传统的漏洞管理工具只能监控传统IT环境，攻击面上的现代资产成为企业盲点，利于云、工业资产和容器环境。
- 低频的扫描。传统的漏洞管理计划只能以低频定期评估网络，提供有限的时间点快照，导致安全团队据以采取行动的信息非常过时又不完整。
- 匮乏的指标。传统的漏洞管理工具缺乏有意义的有效指标，通常只能衡量修复数量或修补工作量，而无法度量这些行动队降低重要业务资产的风险产生了多大影响。

基于风险的漏洞管理：
- 将漏洞数据与上下文元素（如资产重要性、威胁）相关联分析，利用情报帮助企业了解实际风险。
- 将漏洞数据转化为有意义的洞见，使企业专注于构成最大风险的前3%的漏洞.
- 基于风险的漏洞管理超越了传统的IT资产，为企业提供完整的攻击面可见性，不论资产类型或网络位置为何。
- 能够持续评估已知的资产，并立即发现何评估新资产，超越传统的漏洞管理中所采用的静态、被动式实践。
- 采用机器学习算法，处理大量的威胁、漏洞、资产数据，几秒钟内为漏洞提供准确的风险评分。


基于风险的管理cyber exposure 生命周期：
- 资产发现：识别并定位每项资产，获取企业整个攻击面的可见性；
- 风险评估：了解所有资产的状态，包括漏洞、错误配置以及其它健全指标
- 优先级分析：结合上下文环境了解风险暴露情况，根据资产重要性、威胁环境、漏洞严重程度，确定哪些漏洞需要优先修复。
- 修复：运用适当的修复或缓解技术
- 度量：计算、传达并对比主要成熟度指标，从而促进风险降低。
