# 等级保护安全设计要求
> GB/T 25070-2019 

## 8 第三级系统安全保护环境设计

### 8.1 设计目标
第三级系统安全保护环境的设计目标是:按照GB 17859-1999 对第二级系统的安全保护要求。在第二级.系统安全保护环境的基础上，通过实现基于安全策略模型和标记的强制访问控制以及增强系统的审计机制，使系统具有在统一安全策略管控下，保护敏感资源的能力，并保障基础计算资源和应用程序可信，确保关键执行环节可信。

### 8.2 设计策略

第三级系统安全保护环境的设计策略是:在第二级系统安全保护环境的基础上.遵循 GB 17859-1999 的4.3中相关要求。构造非形式化的安全策略模型，对主、客休进行安全标记，表明主、客休的级别分类和非级别分类的组合，以此为基础，按照强制访问控制规则实现对主体及其客体的访问控制。第三级系统安全保护环境在使用密码技术设计时，应支持国家密码管理主管部门批准使用的密码算法，使用国家密码管理主管部门认证核准的密码产品，遵循相关密码国家标准和行业标准。

第三级系统安全保护环境的设计通过第三级的安全计算环境、安全区域边界、安全通信网络以及安全管理中心的设计加以实现。计算节点都应基于可信根实现开机到操作系统启动，再到应用程序启动的可信验证，并在应用程序的关键执行环节对其执行环境进行可信验证，主动抵御病毒入侵行为，并将验证结果形成审计记录，送至管理中心。

### 8.3 设计技术要求
#### 8.3.1 安全计算环境设计技术要求

##### 8.3.1.1 通用安全计算环境设计技术要求

a）用户身份鉴别

应支持用户标识和用户鉴别。在对每一个用户注册到系统时，采用用户名和用户标识符标识用户身份，并确保在系统整个生存周期用户标识的唯一性；在每次用户登录系统时，采用受安全管理中心控制的口令、令牌、基于生物特征、数字证书以及其他具有相应安全强度的两种或
两种以上的组合机制进行用户身份鉴别，并对鉴别数据进行保密性和完整性保护。


b) 自主访问控制

应在安全策略控制范围内，使用户对其创建的客体具有相应的访问操作权限.井能将这些权限的部分或全部授予其他用户。自主访问控制主体的粒度为用户级，客体的粒度为文件或数据库表级和(或)记录或字段级。自主访问操作包括对客体的创建、读、写、修改和删除等。

c） 标记和强制访问控制

在对安全管理员进行身份鉴别和权限控制的基础上，应由安全管理员通过特定操作界面对主、客体进行安全标记;应按安全标记和强制访间控制规则对确定主体访问客体的操作进行控制。强制访问控制主体的粒度为用户级，客体的粒度为文件或数据库表级。应确保安全计算环境内的所有主、客体具有一致的标记信息，并实施相同的强制访问控制规则。

d） 系统安全审计

应记录系统的相关安全事件。审计记录包括安全事件的主体、客体、时间、类型和结果等内容。应提供审计记录查询、分类、分析和存储保护；确保对特定安全事件进行报警；确保审计记录不被破坏或非授权访问。应为安全管理中心提供接口；对不能由系统独立处理的安全事件，提供由授权主体调用的接口。

e）用户数据完整性保护

应采用密码等技术支持的完整性校验机制，检验存储和处理的用户数据的完整性，以发现其完整性是否被破坏，且在其受到破坏时能对重要数据进行恢复。

f）用户数据保密性保护
应采用密码等技术支持的保密性保护机制。对在安全计算环境中存储和处理的用户数据进行保密性保护。

g）客体安全重用

应采用具有安全客体复用功能的系统软件或具有相应功能的信息技术产品，对用户使用的客体资源，在这些客体资源重新分配前，对其原使用者的信息进行清除，以确保信息不被泄露。


h）可信验证

可基于可信根对计算节点的BIOS、引导程序、操作系统内核、应用程序等进行可信验证。并在应用程序的关键执行环节对系统调用的主体、客体、操作可信验证.并对中断、关键内存区域等执行资源进行可信验证，并在检测到其可信性受到破坏时采取措施恢复。并将验证结果形成审计记录。送至管理中心。



i）配置可信检查

应将系统的安全配置信息形成基准库，实时监控或定期检查配置信息的修改行为，及时修复和基准库中内容不符的配置信息。

j）入侵检测和恶意代码防范

应通过主动免疫可信计算检验机制及时识别入侵和病毒行为，并将其有效阻断。

##### 8.3.1.2 云安全计算环境设计技术要求

本项要求包括:

a）用户一身份鉴别

应支持注册到云计算服务的云租户建立主子账号，并采用用户名和用户标识符标识主子账号用户身份。

b）用户账号保护

应支持建立云租户账号体系，实现主体对虚拟机、云数据库、云网络、云存储等客体的访问授权。

c）安全审计

应支持对云服务商和云租户远程管理时执行的特权命令进行审计。

应支持租户收集和查看与本租户资源相关的审计信息，保证云服务商对云租户系统和数据的访问操作可被租户审计。

d）入浸防范

应能检测到虚拟机对宿主机物理资源的异常访问。应支持对云租户进行行为监控，对云租户发起的恶意攻击或恶意对外连接进行检测和告警。

e）数据保密性保护

应提供重要业务数据加密服务，加密密钥由租户自行管理；应提供加密服务，保证虚拟机在迁移过程中重要数据的保密性。

f）数据备份与恢复

应采取冗余架沟或分布式J构设计;应支持数据多副本存储方式;应支持通用接口确保云租户可以将业务系统及数据迁移到其他云计算平台和本地系统，保证可移植性。

g）虚拟化安全

应实现虚拟机之间的CPU、内存和存储空间安全隔离，能检测到非授权管理虚拟机等情况.并进行告警;应禁止虚拟机对宿主机物理资源的直接访问，应能对异常访问进行告警;应支持不同云租户虚拟化网络之间安全隔离;应监控物理机、宿主机、虚拟机的运行状态。

h）恶意代码防范
物理机和宿主机应安装经过安全加固的操作系统或进行主机恶意代码防范；虚拟机应安装经过安全加固的操作系统或进行主机恶意代码防范;应支持对web应用恶意代码检测和防护的能力。

i）镜像和快照安全
应支持镜像和快照提供对虑拟机镜像和快照文件的完整性保护;防止虚拟机镜像、快照中可能存在的敏感资源被非授权访问；针对重要业务系统提供安全加固的操作系统镜像或支持对操作系统镜像进行自加固。

##### 8.3.1.3移动互联安全计算环境设计技术要求
本项要求包括;

a) 用户身份鉴别

应对移动终端用户实现基于口令或解锁图案、数字证书或动态口令、生物特征等方式的两种或两种以上的组合机制进行用户身份鉴别。

b）标记和强制访问控制

应确保用户或进程对移动终端系统资源的最小使用权限;应根据安全策略，控制移动终端接入访问外设，外设类型至少应包括扩展存储卡、GPS等定位设备、蓝牙、NFC等通信外设，并记录日志。

c）应用管控

应具有软件白名单功能，能根据白名单控制应用软件安装、运行;应提供应用程序签名认证机制，拒绝未经过认证签名的应用软件安装和执行。

d）安全域隔离

应能够为重要应用提供基于容器、虚拟化等系统级隔离的运行环境，保证应用的输入、输出、存储信息不被非法获取。

e)移动设备管控

应基于移动设备管理软件,实行对移动设备全生命周期管控。保证移动设备丢失或被盗后，通过网络定位搜寻设备的位置、远程锁定设备、远程擦除设备上的数据、使设备发出警报音，确保在能够定位和检索的同时最大程度地保护数据。

f）数据保密性保护

应采取加密、混淆等措施.对移动应用程序进行保密性保护，防止被反编译;应实现对扩展存储设备的加密功能，确保数据存储的安全。

g）可信验证
应能对移动终端的引导程序、操作系统内核、应用程序等进行可信验证，确保每个部件在加载前的真实性和完整性。


#### 8.3.2 安全区域边界设计技术要求

##### 8.3.2.1 通用安全区域边界设计技术要求

本项要求包括;
a）区域边界访问控制

应在安全区域边界设置自主和强制访问控制机制，应对源及目标计算节点的身份、地址、端口和应用协议等进行可信验证，对进出安全区域边界的数据信息进行控制.阻止非授权访问。

b）区域边界包过滤

应根据区域边界安全控制策略，通过检查数据包的源地址、目的地址、传输层协议、清求的服务等。确定是否允许该数据包进出该区域边界。

c）区域边界安全审计

应在安全区域边界设置审计机制，山安全管理中心集中管理，并对确认的违规行为及时报警。

d)区域边界完整性保护

应在区域边界设置探测器，例如外接探测软件，探测非法外联和入侵行为，并及时报告安全管理中心。

e）可信验证

可基于可信根对计算节点的BIOS、引导程序、操作系统内核、区域边界安全管控程序等进行可信验证，并在区域边界设备运行过程中定期对程序内存空间、操作系统内核关键内存区域等执行资源进行可信验证，并在检测到其可信性受到破坏时采取措施恢复，并将验证结果形成审计记录送至管理中心。

##### 8.3.2.2云安全区域边界设计技术要求
本项耍求包括:

a）区域边界结构安全
应保证虚拟机只能接收到目的地址包括自己地址的报文或业务需求的广播报文、同时限制广播玫击;应实现不同租户间虚拟网络资源之间的隔离，并避免网络资源过量占用;应保证云计算平台管理流量与云租户业务流量分离。

应能够识别、监控虚拟机之间、虚拟机与物理机之间的网络流量;提供开放接口或开放性安全服务，允许云租户接入第三方安全产品或在云平台选择第三方安全服务。

b）区域边界访问控制

应保证当虚拟机迁移时，访问控制策略随其迁移;应允许云租户设置不同虚拟机之间的访问控制策略;应建立租户私有网络实现不同租户之间的安全隔离;应在网络边界处部署监控机制，对进出网络的流量实施有效监控。

c）区域边界入侵防范
当虚拟机迁移时，入侵防范机制可应用于新的边界处;应将区域边界入侵防范机制纳入安全管理中心统一管理。应向云租户提供互联网内容安全监测功能，对有害信息进行实时检测和告警。

d）区域边界审计要求
根据云服务商和云租户的职责划分。收集各自控制部分的审计数据;根据云服务商和云租户的职责划分.实现各自控制部分的集中审计;当发生虚拟机迁移或虚拟资源变更时、安全审计机制可应用于新的边界处;为安全审计数据的汇集提供接口，并可供第三方审计。

##### 8.3.2.3 移动互联安全区域边界设计技木要求
###### 8.3.2.3.1区域边界访问控制
应对接入系统的移动终端，采取基于 SIM 卡、证书等信息的强认证措施; 应能限制移动设备在不同工作场景下对WiFi、3G、4G等网络的访问能力。

###### 8.3.2.3.2区域边界完整性保护
移动终端区域边界检测设备监控范围应完移覆盖移动终端办公区，并具备无线路由器设备位置检测功能，对于非法无线路由器设备接入进行报警和阻断。

#### 8.3.3 安全通信网络设计技术要求
##### 8.3.3.1通用安全通信网络设计技术要求
本要求包括:

a)通信网络安全审计

应在安全通信网络设置审计机制，由安全管理中心集中管理，并对确认的违规行为进行报警。

b）通信网络数据传输完整性保护

应采用由密码技术支持的完整性校验机制，以实现通信网络数据传输完格性保护。并在发现完整性被破坏时进行恢复。

d) 通信网络数据传输保密性保护

应采用由密码技术支持的保密性保护机制，以实现通信网络数据传输保密性保护。

e）可信连接验证

通信节点应采用具有网络可信连接保护功能的系统软件或可信根支撑的信息技术产品，在设备连接网络时，对源和目标平台身份、执行程序及其关键执行环节的执行资源进行可信验证，并将验证结果形成审计记录，送至管理中心。

##### 8.3.3.2云安全通信网络设计技术要求
要求包括:
a）通信网络数据传输保密性

应支持云租户远程通信数据保密性保护:.
应对网络策略控制器和网络设备(或设备代理)之间网络通信进行加密。

b）通信网络可信接入保护
应禁止通过互联网直接访问云计算平台物理网络;应提供开放接口.允许接入可信的第三方安全产品。

c）通信网络安全审计
应支持租户收集和查看与本租户资源相关的审计信息;应保证云服务商对租户通信网络的访问操作可被租户审计。


##### 8.3.3.3移动互联安全通信网络设计技木要求
木项要求包括:

a）通信网络可信保护
应通过 VPN 等技术实现基于密码算法的可信网络连接机制。通过对连接到通信网络的设备进行可信检验，确保接入通信网络的设备真实可信，防止设备的非法接入。

#### 8.3.4安全管理中心设计技术要求
##### 8.3.4.1系统管理

可通过系统管理员对系统的资源和运行进行配置、控制和可信及密码管理.包括用户身份、可信证书及密钥、可信基准库、系统资源配置、系统加软件启动、系统运行的异常处理、数据和设备的备份与恢复等。
    
应对系统管理员进行身份鉴别.只允许其通过特定的命令或操作界而进行系统管理操作。并讨这些操作进行审计。

在进行云计算平台安全没计时，安全管理应提供查询云租户数据及备份存储位置的方式；云计算平台的运维应在中国境内，境外对境内云计算平台实施运维操作应遵循国家相关规定。

在进行物联网系统安全设计时，应通过系统管理员对感知设备、感知网关等进行统一身份标识管理；应通过系统管理员对感知设备状态(电力供应情况、是否在线、位置等)进行统一监测和处理。

##### 8.3.4.2安全管理

应通过安全管理员对系统中的主体、客体进行统一标记，对主体进行授权，配代可信验证策略，维护策略库和度量值库。

应对安全管理员进行身份鉴别，只允许其通过特定的命令或操作界面进行安全管理操作，井进行审计。

在进行云计算平台安全设计时，云计算安全管理应具有对攻击行为回溯分析以及对网络安全事件进行预测和预警的能力:应具有对网络安全态势进行感知、预测和预判的能力。

在进行物联网系统安全设计时，应通过安全管理员对系统中所使用的密钥进行统一管理，包括密钥的生成、分发、更新、存储、备份、销毁等。

在进行工业控制系统安全设计时，应通过安全管理员对工业控制系统设备的可用性和安全性进行实时监控.可以对监控指标设置告警闽值。触发告警并记录;应通过安全管理员在安全管理中心呈现设备间的访问关系。及时发现未定义的信息通讯行为以及识别重要业务操作指令级的异常:

##### 8.3.4.3审计管理

应通过安全审计员对分布在系统各个组成部分的安全审计机制进行集中管理，包括根据安全审计策略对审计记录进行分类;提供按时间段开启和.关闭相应类型的安全审计机制;对各类审计记录进行存储、管理、查询等。对审计记录应进行分析。并根据分析结果进行处理。

应对安全审计员进行身份鉴别，只允许其通过特定的命令或操作界面进行安全审计操作。

在进行云计算平台安全没计时，云计算平台应对云服务器、云数据库、云存储等云服务的创建、删除等操作行为进行审计;应通过运维审计系统对管理员的运维行为进行安全审计;应通过租户隔离机制，确保审计数据隔离的有效性。

在进行工业控制系统安全设计时，应通过安全管现员对工业控制现场控制设备、网络安全设备、网络设备、服务器、操作站等设备中主体和客体进行登记.井对一各设备的网络安全监控和报警、网络安全日志信息进行集中管理。根据安全审计策略对各类安全信息进行分类管理与查询.并生成统一的审计报告。系统对各类网络安全报警和日志信息进行关联分析。

