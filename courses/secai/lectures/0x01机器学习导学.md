# 机器学习与安全内容导学

本节主要回答：
- 什么是机器学习？
- 机器学习与安全有什么关系？


## 机器学习的基本概念

- 是T800终结者？

![T800终结者](images\t800.jpeg)

- 还是

![matrix黑客帝国](images\matrixers.jpg)



通常，一个机器学习问题（learning problem）是通过研究由n个样本（sample）组成的已有数据（老数据）集合（set），然后尝试着预测未知数据（新数据）的某些特性。如果每个样本不只是一个数字，例如是多维的实体（即多变量数据），我们称这些多维数据为特性（features）或者属性（attributes）。


### 机器学习的定义

维基百科对机器学习的定义：

**机器学习是近20多年兴起的一门多领域交叉学科，涉及概率论、统计学、逼近论、凸分析、算法复杂度理论等多门学科。机器学习理论主要是设计和分析一些让计算机可以自动“学习”的算法。机器学习算法是一类从数据中自动分析获得规律，并利用规律对未知数据进行预测的算法。**

![机器学习基础训练过程](images/01/机器学习基础训练过程.jpg)

机器学习(Machine Learning,ML) 是使用计算机来彰显数据背后的真实含义，它为了把无序的数据转换成有用的信息。专门研究计算机怎样模拟或实现人类的学习行为，以获取新的知识或技能，重新组织已有的知识结构使之不断改善自身的性能。 它是人工智能的核心，是使计算机具有智能的根本途径，其应用遍及人工智能的各个领域，它主要使用归纳、综合而不是演绎。

因为学习算法中设计了大量的统计学理论，机器学习与统计推断学尤为密切，**也被称为统计学习理论。**

学习“机器学习、深度学习、人工智能”这些课很难吧？

<div> <video controls="controls" src="images\01\studentsjob.webm"  type="video/webm"  style="width:100%" alt="..." ></div>

---



### 机器学习的发展历程

机器学习是人工智能（artificial intelligence）研究到一定阶段的必然产物。

- 1950s-1970s初，人工智能研究处于“推理期”，那时人们以为只要赋予机器逻辑推理能力，机器就会具有智能。

主要代表是A.Newell和H.Simon的“逻辑理论家"(Logic Theorist)程序、“通用问题求解”（general problem solving)程序。这些程序取得了令人振奋的结果，例如逻辑理论家1952年证明了罗素和怀特海名著《数学原理》中的38条定理，1963年证明了全部52条定理，甚至有些证明的更巧妙。A.Newell和H.Simon因此获得了1975年图灵奖。

然而，后续研究认为，仅有逻辑推理能力远远不能实现人工智能。

- 1970s末-1980，人工智能研究进入“知识期”。大量专家系统问世，取得了许多应用结果。

E.A.Feigenbaum作为“知识工程”之父在1994年获得图灵奖。

但人们逐渐认为，专家系统面临“知识工程瓶颈”，简单地说，就是由人来把知识总结出来，再教给计算机是相当困难的。机器应该能自己学习。

- 1980s-1990s中，人工智能研究进入机器学习时期。机器学习成为一个独立的学科领域，各种机器学习技术百花绽放。机器学习又分为以下类别：

  - “从样例中学习”：
    + 其中一大主流是符号主义学习，其代表包括：决策树、基于逻辑的学习。典型的决策树学习以信息论为基础，以信息熵的最小化位目标，直接模拟了人类对概念进行判定的树形流程。
    + 另一主流技术是神经网络的连接主义学习。这种学习在1950s取得大发展，但当时人们更喜欢符号表示，所以当时连接注意的研究未被纳入主流研究。直到1983年J.J.Hopfield利用神经网络求解了“流动推销员问题”这个NP难题，1986年，D.E.Rumelhart等重新发明了著名的BP算法之后，人们才开始重视神经网络。事实商，BP一直是应用最广的机器学习算法。连接主义最大的问题是“试错性”，学习过程中存在大量参数，参数设置缺少理论指导，主要靠人工调参，参数调节失之毫厘，学习结果谬以千里。
    
- 1990s-2000，“统计学习”（statistical learning）闪亮登场并占据主流，代表性技术是支持向量机（Support Vector Machine，简称SVM），以及更为一般的“核方法”（kernel methods）。

这方面的研究始于1960s，但SVM在1990s才提出。

- 2000初，连接主义学习卷土重来，以深度学习之名，掀起热潮。

深度学习，狭义地说就是“很多层”的神经网络，在涉及语音、图像等复杂对象的应用中，取得了优秀性能。

以往，机器学习技术在应用中要取得好的性能，对使用者要求很高；

深度学习技术涉及的模型复杂度很高，只要下功夫“调参”，性能往往很好。因此，深度学习虽然缺乏严格的理论基础，但它显著降低了机器学习应用者的门槛。

2006年，卡耐基梅隆大学宣告成立世界上第一个“机器学习系”，机器学习奠基人之一的T.Mitchell教授出任首任系主任。

2012年，美奥巴马政府启动“大数据研究与发展计划”，美国国家科学基金会旋即在加州大学伯克利分校启动加强计划，强调要深入研究和整合大数据时代的三大关键技术：机器学习、云计算、中报（crowdsourcing）。收集、存储、传输、管理大数据的目的，是为了“利用”大数据，没有机器学习技术分析数据，则“利用”无从谈起。

### 学习机器学习课程的意义

以机器学习为核心的人工智能给社会带来了非常大的变化。有人认为它对社会的影响应该比互联网对整个社会的影响更加深远...

#### 演进历史

从学术上看，机器学习是一个老东西了，比如 Neural Network（神经网络）在很早以前就已经提出了，但是一直没有什么突破，直到最近才有些进展。

从产业角度来看，机器学习有2个重要的阶段：

- **第一个阶段：机器识别图像达到了人类水平**

![机器超越人类](images\01\机器超越人类.png)

在 AlphaGo 之前，人工智能仅仅是极少数人讨论的内容，是只有研究和从事相关工作的人之间才会有的谈资和话题，平常的百姓既不懂也不感兴趣。到 AlphaGo 之后，大家都开始谈论了。技术要跟人比、要超过人类、要有用。

- **第二个阶段：人工智能进化的速度异常迅速**

AlphaGo 最早的时候是在欧洲打败了欧洲冠军，一位职业二段选手，也是个中国人；过了六个月之后，AlphaGo 跟李世石下棋，只输了一局，总比分 4：1 取得胜利。在此之后，网络上出现了一个叫做 Master 的棋手，横扫中日韩棋手，并保持 60 局不败；随后 AlphaGo 2.0 与柯洁对局，结果人类选手当然还是输了。

AlphaGo 2.0 当时的水平到什么程度呢？让三子而不败。后来聂卫平发表感慨说：AlphaGo 2.0 现在已经是是 20 段的选手了。AlphaGo 现在变成一个统一的程序，不论围棋还是象棋，用一个程序基本上全部摆平了。后来，不论是电子竞技还是德州扑克、桥牌等游戏，人工智能都可以搞得定，前不久 DeepMind 发表的一篇论文，也是 AI 在游戏里打败了人类选手。

这几个案例想告诉大家的是：AI 一旦有足够的数据，或者 AI 真的适应某个领域的话，它的演进速度是非常快的，比如围棋从二段到九段，到孤独求败，再到现在不知道到几段，很快就可以达成。历史上看，棋圣级别的高手是凤毛麟角，但是 AlphaGo 把整个围棋界颠覆了。

#### 对社会的影响

这里有一张图，叫“全球人均收入按年代的数值图”，来源于加州大学的教授 Gregory Clark，这是对于全球的经济历史做的统计。

![全球人均收入按年代的数值图](images\01\全球经济历史统计.png)

从劳动生产力的历史来看，公元前1000 年到公元 1800 年左右，就是在图中工业革命的箭头之前，人均收入几乎没有大的变化。

但是，从1801年左右，工业革命开始到今天，变化是翻天覆地的。短短两百年的时间，一切都变了。我们今天的日常用品，我们居住的建筑、用的电子产品，都是这两百年的产物。

工业革命给人类带来了前所未有的变化，如果反映到劳动生产率上，人均的劳动生产率在过去仅仅两百年左右的时间里提升了 10 倍，而之前将近三千年里，劳动生产率几乎没有改变。

为什么会这样？以史为鉴，感知未来，人类能有今天的进步，主要是人类的劳动形式发生了根本性变化。不同的劳动形式效率是不一样的，在工业革命之前，人类去改造这个世界基本都是靠体力，效率是非常低下的，而工业革命用能源加机械替代了人的体能。

![智能颠覆社会](images\01\智能颠覆社会.png)

**智能化去替代人类的技能劳动。人类经过长时间培训可以做好的事情，机器能做得更好。**

现代社会劳动力约有 90% 都是从事技能劳动的，不论是司机、厨师或者是服务人员，都是依靠技能进行劳动的。随着智能革命不断的深入，会替代掉几乎所有的技能劳动，进而把人类逼到另外一个地方，叫创新。

![产业格局彻底改变](images\01\产业格局彻底改变.png)

举个例子：计算机视觉在医学影像上进展还是比较快的，计算机通过对患者医疗影像的扫描，可以直接给医生一个判断，不是辅助医生诊断，而是可以直接给出结论。

这导致2018年美国的医学院的医学影像专业报考率骤降，因为大家很担心学医读到博士之后，突然失业了。

这种事情引起了人们不安，今后，人们想靠学会一项技能，一直在一个行业里工作，就能把自己的一生过的很好的机会可能没有了，我们需要不断的思考与创新。

#### 对未来的意义和发展

**AI 的发展路径，将从低技能行业到高技能行业；高数据行业到低数据行业；经济效益高的行业到经济效益一般的行业。**

![AI 的发展路径](images\01\AI的发展路径.png)

人工智能的成本永远都是下降的，同等价格的算力只会越来越便宜，但是人工成本一定是升高的，因为雇佣 AI 人才的费用一定会上涨。

#### AI 时代科技公司的机会

##### 大科技公司的优势

对于大的科技公司来说，主要是拿自己的数据，做各种各样的处理，看它的商业价值。很多人认为，小公司是不是没机会，因为小公司没数据。

![大科技公司的优势](images\01\大科技公司优势.png)

##### 创业公司的优势

但实际上，从人才的角度来说，优秀的人，到一定的时候是愿意去创业的，他们成功的可能性是很大的；从数据角度来看，其实并不用比别人的数据大，比如农业、工业、医疗等等领域，大家都没数据，都是两眼一抹黑，那就可以做，比如人脸识别、医疗影像识别等等。从投资角度来看，只要证明能赚钱，就一定不缺投资。

![创业公司的优势](images\01\创业公司优势.png)

##### 传统企业的机会

传统产业如果有数据，是可以去做的，跟科研机构合作也好，做投资也好，都可以有所作为。但传统产业自己建立一个 AI 团队是不合适的，因为很难留住人才。由于企业文化等各种问题，很多 AI 人才或者互联网人才到传统企业里面都待不长。因此，传统企业与科技公司进行合作或者投资相对来讲是更合适。

![传统企业的机会](images\01\传统企业的机会.png)

##### 美国的优势和挑战

美国的科技积累极其深厚，人才储备世界第一、科技沉淀深厚。其次，美国市场是全球市场，任何一个科技公司的收入，美国大部分都占一半。

当然，美国面临的挑战也很大。一是中产阶级带来的政治挑战，二是美国国内形势每况愈下。

![美国的优势和挑战](images\01\美国的优势和挑战.png)

##### 中国的机会

![中国的机会](images\01\中国的机会.png)

中国也有这样几方面的机会。首先是广阔的市场，中国是全球最大的商业化市场，叫汉文化圈，市场越大，越支持创新；其次是技术跨越式的进步，由于中国从现金支付直接跨越到了移动支付时代，在技术的升级上也得到了飞跃式的提升；从技术追赶的角度来说，中国大学的提名提升很快，优质人才的比例也不断在提升，在论文的贡献等方面已经超过了美国；在创新能力上，中国以前比较落后，靠模仿国外的软件发展，但是最近这些年形势发生了反转，一些国外的企业开始模仿中国的技术产品；另外就是中国投资，2017 年的数据，中国的 AI 投资大概是在全球是排第一的，占到全球早期 AI 投资的 48%，美国是 38%。

### 机器学习的典型应用

机器学习广泛应用于：
- 网络搜索
- 垃圾邮件过滤
- 推荐系统 
- 广告投放 
- 信用评价
- 欺诈检测
- 股票交易
- 医疗诊断系统。

下面我们介绍一些典型应用：

#### 图像分类识别

请看下面的图像，它们可以归为一种类型么？

![各种各样的勺子.png](images\laddles.png)

你能发现其中的共性么？

目前，机器识别图片的能力已经逼近，甚至超越了人的识别能力。国际计算机视觉比赛ImageNet2012挑战赛（斯坦福等高校共建）。共有1000个类别，每个类别有1200张图片。

![Imagenet2012](images\imagenet2012.png)

  - 任务1：图像分类（预测类别标签）
  - 任务2：物体检测定位（classification+localization）
  - 任务3：细粒度分类
  - 任务4：场景分类
  
下图中，我们可以看出，2012年的错误率有了大幅降低，达到了16%。
  
![Imagenet2012最好算法的性能](images\imagenet2012tj.png)

其原因是引入了卷积神经网络（Convolutional neural Networks）模型，这是多伦多大学（University of Toronto）的Alex Krizhenvsky, Ilya Sutskever, Geoffrey Hinton等人的工作，使得计算机视觉的算法性能有了质的飞跃。下图就是当时（2012）Alex教授提出的Convolutional Neural network：

![Alex的卷积神经网络模型](images\alex卷积神经网络2012.png)

2015年，微软的神经网络系统错误率为4.94%，低于人类测试者的5.1%。机器学习载图片分类识别上有了本质上的突破。

| | layers| error（top5）||
|-|-|-|-|
|AlexNet|8|15%|2012|
|VGGNet|19|7.32%|2014|
|GooleNet|22|6.66%|2014|
|MSRA|152|3.57%|2016|

由此无数科研人员被此所吸引。

#### 游戏

又例如Alpha-Go和Alpha-Zero
Google收购的Deepmap增强学习团队设计的Alpha-Go，战胜了人类围棋冠军李世石。

![alphago](images\alphago.png)
![alphago](images\alphago-arch.png)

上面的例子揭示了机器学习进入了新时代，称之为大数据机器学习时代。

更早一点的例子：1997年IBM的深蓝战胜了世界国际象棋大师卡斯帕罗夫。1997年的深蓝，运算速度为每秒2亿步棋。是1996年版本深蓝运算速度的2倍。那时的深蓝在世界超级计算机排名中为259位。

#### 文语转换和语音识别

这两者都是机器学习的传统研究领域。
![gene](images\文语转换.png)

#### 生物信息学

例如：找到感兴趣的基因

![gene](images\基因搜索1.png)
![alphago](images\基因搜索2.png)

#### 量化投资

![alphago](images\quantativeinvest.png)

#### 机器人控制

![alphago](images\roboticcontrol.png)

#### 失传手工艺再现

![alphago](images\失传手工艺再现.png)

#### 安全检测



### 机器学习的主要任务

- 分类：将实例数据划分到合适的分类中；
- 回归：预测数值型（连续性）数据；
- 聚类：将数据集合分成若干个类别；
- 降维：降低数据的维数，简化数据；
- 密度估计：寻找数据统计值；
- 特征分析：提取出数据的关键信息。


### 机器学习的一般分类

![机器学习基础训练过程](images/01/机器学习基础训练过程.jpg)

#### 监督学习（Superised Learning）

- 从给定的数据集中，训练一个函数，根据这个函数可以对新的数据进行预测或分类。
- 由于训练过程中需要人工对数据样本进行标记（即告诉机器每一条训练数据的计算结果），所以叫做监督学习。
- 在监督学习中，常见的学习问题有：
  + 分类问题
  + 回归问题

#### 无监督学习（Unsupervised Learning）

- 从给定的数据集中，训练一个函数，根据这个函数可以对新的数据进行预测或分类。
- 由于训练过程中不需要人工对数据样本进行标记，所以叫做无监督学习。
- 无监督学习中，常见的学习问题有：
  - 聚簇问题
  - 密度预测问题

#### 半监督学习（Semi-supermised Learning）

- 介于监督学习和无监督学习之间，人工完成一定量的标记工作。
  
#### 强化学习（Reinforement Learning）


- 强化学习，强调如何基于环境而行动，以取得最大化的预期利益。其灵感来源于心理学中的行为主义理论，即有机体如何在环境给予的奖励或惩罚的刺激下，逐步形成对刺激的预期，产生能获得最大利益的习惯性行为。
- 强化学习最早可以追溯到巴甫洛夫的条件反射实验，它从动物行为研究和优化控制两个领域独立发展，最终经Bellman之手将其抽象为马尔可夫决策过程 (Markov Decision Process，MDP)
- AlphaGo Zero就运用了强化学习，不需要大量数据，就可以达到训练的效果，因为机器在自己试错。

#### 深度学习（Deep Learning）

- 利用神经网络方法，形成知识的表示。
- 经典机器学习算法适于解决可结构化数据的分类预测问题，如房价预测、患病预测等；
- 深度学习算法适于非结构化数据的部分问题，如图片分类、文本分类等。
  
### 机器学习的一般方法

**如何做到从入门到精通，而不是从入门到放弃？**

#### 循序渐进

- 不要想一口吃成个胖子
- 要循序渐进地学
- 要反反复复地学

#### 基础知识部分

- 要坚持学习高等数学、线性代数、概率论等数学知识，经常复习；
- 要坚持学习机器学习中的具体算法。

#### 应用知识部分

- 要能够运用计算机程序对一定的数据样本进行分析，掌握运用理论进行实际的技能。
- 要经常阅读优秀的算法实现代码，提高自己的算法实现能力。

#### 实践提高部分

- 要关注社会问题，尝试获取数据和分析数据
- 要积极参加各类竞赛，在比赛中学习和提高。


### 我们学习的目标

- 理解基本的机器学习原理及算法  

- 掌握利用所学解决实际问题的能力  

  + 能够根据实际问题**选择合适的算法**  
  
  + 能够根据实际问题**分析和收集数据**  
  
- 掌握已有机器学习工具（如sklearn库）常用算法的使用技巧  

### 开发机器学习程序的步骤

#### 收集数据  

首西安需要使用多种方法收集数据，例如：编写爬虫程序收集网上数据。

#### 准备数据输入

得到数据后，要将数据格式进行整理，即进行数据的清洗和预处理。

#### 分析输入数据

在使用算法或计算机之前，人工要预先分析输入数据，根据一定的经验对数据进行判断。例如：查看数据是否稀疏、有无异常值等。

#### 训练算法

对获得的数据进行分组，其中一部分作为训练数据集，用于训练模型。建立模型的目的是为了使用计算机解决实际问题，所以使用何种算法要充分考虑实际需求。

#### 测试算法

训练得到的模型需要经过测试检验，才能用于后续的预测。为了评估算法，必须设立一定的技术指标来评价算法的学习效果。

#### 应用算法进行预测

将算法转化为应用程序，对新的数据进行预测。同时检验预测效果，并进行算法的优化迭代。

### 推荐读物

- 周志华著，《机器学习》 清华大学出版社出版，2016年；
- Christopher M Bishop著，《Pattern Recognition and Machine Learning》，Springer出版；
- 在线课程Coursera版：http://t.cn/RJZQbV2
- Stanford手版书：Http://t.cn/RwUWKMS ,课程主页：http://cs229.stanford.edu/
- 深度学习网络课程：http://cs231n.stanford.edu/
- 增强学习网络课程：http://t.cn/Rw0rwtU


### Python机器学习库

本门课程中，我们主要使用的是:https://scikit-learn.org/stable/

![scikit-learn.png](images\scikit-learn-logo-small.png)

scikit-learn是一个使用Python语言编写的机器学习库。它有以下几个特点：

- 是简单而又方便的数据挖掘和数据分析工具；
- 各种应用场景都可以使用；
- 基于NumPy、SciPy、matplotlib；
- 是基于BSD协议的开源、商业可用的工具库

#### Scikit-learn库中包含的模型类型：

- 分类模型（Classification）: 用于标识出某个对象所属的类型。
  * 应用：垃圾邮件检测（Spam detection）、图像识别（Image recognition）...
  * 算法：K邻近算法（KNN）、支持向量机（SVM）、随机森林（random forest）...  
  
- 回归模型（Regression）：用于预测与某个对象相关的某个连续值属性的数值。
  * 应用：毒性反应（Drug response）、股票价格...
  * 算法：SVR、ridge regression、Lasso  
  
- 聚簇模型（Clustering）：用于自动地按近似性对对象进行分组。
  * 应用：客户细分（Customer segmentation）、分组实验结果（Grouping experiment outcomes）...
  * 算法：k-Means, spectral clustering, mean-shift, …

- 降维处理（Dimensionality reduction）：减少随机变量的数量。
  * 应用：可视化、增加效率
  * 算法：PCA、特征选择、non-negative matrix factorization,...
  
- 模型选择（Model selection）：比较、验证和选择参数和模型。
  * 目标：经过参数调优，提高精确性。
  * 模型：网格搜索（grid search）、交叉验证（cross validation）、矩阵（matrics）...
  
- 预处理（Preprocessing）：特征提取和规范化（normalization）
  * 应用：将文本等信息转化为恰当的输入数据
  * 模型：预处理、特征提取...

#### sklearn库的安装

sklearn库是在Numpy、Scipy、matplotlib的基础上开发而成的，因此在安装sklearn时，这些基础库也需要被安装好。

- Numpy：开源的科学计算库
- Scipy：基于Numpy的一个集成了多种数学算法和函数的python模块
- matplotlib：一个类似matlab的，基于numpy的python绘图工具。

1. 下载
为了方便，我们选择较为方便安装的anaconda集成环境。大家可以从链接：https://www.anaconda.com/download/ 下载。
2. 安装
安装过程较为简单，执行安装包，就可以完成全部工作。