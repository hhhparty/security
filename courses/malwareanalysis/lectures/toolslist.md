# 恶意代码分析常用工具

## Capstone 全能反编译框架

[Capstone](https://www.capstone-engine.org/) is a lightweight multi-platform, multi-architecture disassembly framework.

Our target is to make Capstone the ultimate disassembly engine for binary analysis and reversing in the security community.

### Highlight features
- Multi-architectures: Arm, Arm64 (Armv8), BPF, Ethereum Virtual Machine, M68K, M680X, Mips, MOS65XX, PowerPC, RISCV, Sparc, SystemZ, TMS320C64X, Web Assembly, XCore & X86 (include X86_64) (details).
- Clean/simple/lightweight/intuitive architecture-neutral API.
- Provide details on disassembled instruction (called “decomposer” by some others).
- Provide some semantics of the disassembled instruction, such as list of implicit registers read & written.
- Implemented in pure C language, with bindings for D, Clojure, F#, Common Lisp, Visual Basic, PHP, PowerShell, Haskell, Perl, Python, Ruby, C#, NodeJS, Java, GO, C++, OCaml, Lua, Rust, Delphi, Free Pascal & Vala available.
- Native support for Windows & *nix (with Mac OSX, iOS, Android, Linux, *BSD & Solaris confirmed).
- Thread-safe by design.
- Special support for embedding into firmware or OS kernel.
- High performance & suitable for malware analysis (capable of handling various X86 malware tricks).
- Distributed under the open source BSD license.


### Python module for Windows/MacOS/Linux - Binaries    
With pip, you can easily install Python module for either Windows, MacOS or Linux.

`pip install capstone`
In case you wish to upgrade from older version of Capstone, do:

`pip install capstone --upgrade`
Remember to stick “sudo” in front for root privilege if needed.

### Brew package for MacOS - Binaries  
Install Brew package of Capstone on MacOS with:

`brew install capstone`
In case you wish to upgrade from older version of Capstone, do:

```
brew update
brew upgrade capstone
```
### Docs
https://www.capstone-engine.org/documentation.html

## Keystone 全能编译框架
[Keystone](https://www.keystone-engine.org/) is a lightweight multi-platform, multi-architecture assembler framework.
### Highlight features:

Multi-architecture, with support for Arm, Arm64 (AArch64/Armv8), Ethereum Virtual Machine, Hexagon, Mips, PowerPC, Sparc, SystemZ, & X86 (include 16/32/64bit).
Clean/simple/lightweight/intuitive architecture-neutral API.
Implemented in C/C++ languages, with bindings for Java, Masm, Visual Basic, C#, PowerShell, Perl, Python, NodeJS, Ruby, Go, Rust, Haskell & OCaml available.
Native support for Windows & *nix (with Mac OSX, Linux, *BSD & Solaris confirmed).
Thread-safe by design.
Open source.
Keystone is based on LLVM, but it goes much further with a lot more to offer.

### Python module for Windows/MacOS/Linux - Binaries 
With pip (or pip3 for Python 3 users), you can easily install Python module for either Windows, MacOS or Linux.

`pip install keystone-engine`
In case you wish to upgrade from older version of Keystone, do:

`pip install keystone-engine --upgrade`
Remember to stick “sudo” in front for root privilege if needed.
## IDAPython 

## unicorn 基于qemu的模拟执行框架


[Unicorn](https://www.unicorn-engine.org/) is a lightweight multi-platform, multi-architecture CPU emulator framework.
### Highlight features:

Multi-architectures: Arm, Arm64 (Armv8), M68K, Mips, Sparc, & X86 (include X86_64).
Clean/simple/lightweight/intuitive architecture-neutral API.
Implemented in pure C language, with bindings for Pharo, Crystal, Clojure, Visual Basic, Perl, Rust, Haskell, Ruby, Python, Java, Go, .NET, Delphi/Pascal & MSVC available.
Native support for Windows & *nix (with Mac OSX, Linux, *BSD & Solaris confirmed).
High performance by using Just-In-Time compiler technique.
Support fine-grained instrumentation at various levels.
Thread-safe by design.
Distributed under free software license GPLv2.
### Python module for Windows/MacOS/Linux - Binaries    
With pip or pip3, you can use the same command to install Python module for either Windows, MacOS or Linux.

pip install unicorn
To upgrade from older version of Unicorn, do:

pip install unicorn --upgrade
Remember to stick “sudo” in front for root privilege if needed.

### Brew package for MacOS - Binaries  
Install Brew package of Unicorn on MacOS with:
```brew install unicorn```
To upgrade from older version of Unicorn, do:
```
brew update
brew upgrade unicorn
```
### plugin
- SMC patch https://github.com/wonderkun/unicorn
  - SMC是一种局部代码加密技术，通过对一段代码进行加密来达到增加逆向工程难度或者免杀的目的。 编写SMC代码不是汇编语言的专利。

## flare-emu 基于unicorn的IDA 插件

快速获取不想读的代码的执行结果。

## flare-ida

IDA Pro utilities from FLARE team