# 卷积神经网络 CNN

CNN 有2大特点：
- 能够有效的将大数据量的图片降维成小数据量
- 能够有效的保留图片特征，符合图片处理的原则

目前 CNN 已经得到了广泛的应用，比如：人脸识别、自动驾驶、美图秀秀、安防等很多领域。

## why cnn?

在 CNN 出现之前，图像对于人工智能来说是一个难题，有2个原因：
- 图像需要处理的数据量太大，导致成本很高，效率很低
  - 图像是由像素构成的，每个像素又是由颜色构成的。
  - 非黑即白的二值图像，不压缩的情况下一个像素只需要1个bit；
  - 256种状态的灰度图像，不压缩的情况下一个像素需要8bit
  - 三基色红绿蓝（RGB），不压缩的情况下一个像素需要占用24bit（3字节），这个就是常说的24位真彩色。
  - 所以，RGB颜色系统一个像素要有 一张 1000×1000 像素的图片，我们就需要处理3百万个参数.这么大量的数据处理起来是非常消耗资源的，而且这只是一张不算太大的图片！
- 图像在数字化的过程中很难保留原有的特征，导致图像处理的准确率不高

图片数字化的传统方式我们简化一下，就类似下图的过程：
<img src="images/cnn/传统图片数字化处理示意图.png" width="480">

假如有圆形是1，没有圆形是0，那么圆形的位置不同就会产生完全不同的数据表达。但是从视觉的角度来看，图像的内容（本质）并没有发生变化，只是位置发生了变化。所以当我们移动图像中的物体，用传统的方式的得出来的参数会差异很大！这是不符合图像处理的要求的。

而 CNN 解决了这个问题，他用类似视觉的方式保留了图像的特征，当图像做翻转，旋转或者变换位置时，它也能有效的识别出来是类似的图像。

那么卷积神经网络是如何实现的呢？在我们了解 CNN 原理之前，先来看看人类的视觉原理是什么？

## 人类的视觉原理

深度学习的许多研究成果，离不开对大脑认知原理的研究，尤其是视觉原理的研究。

1981 年的诺贝尔医学奖，颁发给了 David Hubel（出生于加拿大的美国神经生物学家） 和TorstenWiesel，以及 Roger Sperry。前两位的主要贡献，是“发现了视觉系统的信息处理”，可视皮层是分级的。

人类的视觉原理如下：

- 从原始信号摄入开始（瞳孔摄入像素 Pixels）;
- 接着做初步处理（大脑皮层某些细胞发现边缘和方向）;
- 然后抽象（大脑判定，眼前的物体的形状，是圆形的）;
- 然后进一步抽象（大脑进一步判定该物体是只气球）。

下面是人脑进行人脸识别的一个示例：
<img src="images/cnn/人脸识别示例.png" width="480">

对于不同的物体，人类视觉也是通过这样逐层分级，来进行认知的：

<img src="images/cnn/不同物体人类视觉逐层分级.png" width="480">

我们可以看到，在最底层特征基本上是类似的，就是各种边缘，越往上，越能提取出此类物体的一些特征（轮子、眼睛、躯干等），到最上层，不同的高级特征最终组合成相应的图像，从而能够让人类准确的区分不同的物体。

那么我们可以很自然的想到：可以不可以模仿人类大脑的这个特点，构造多层的神经网络，较低层的识别初级的图像特征，若干底层特征组成更上一层特征，最终通过多个层级的组合，最终在顶层做出分类呢？

答案是肯定的，这也是许多深度学习算法（包括CNN）的灵感来源。

## 卷积神经网络-CNN 的基本原理

典型的 CNN 由3个部分构成：
- 卷积层
- 池化层
- 全连接层

如果简单来描述的话：卷积层负责提取图像中的局部特征；池化层用来大幅降低参数量级(降维)；全连接层类似传统神经网络的部分，用来输出想要的结果。


### 卷积——提取特征
卷积层的运算过程如下图，用一个卷积核扫完整张图片：

<img src="images/cnn/卷积层示意图.gif" width="480">

这个过程我们可以理解为我们使用一个过滤器（卷积核）来过滤图像的各个小区域，从而得到这些小区域的特征值。

在具体应用中，往往有多个卷积核，可以认为，**每个卷积核代表了一种图像模式，如果某个图像块与此卷积核卷积出的值大，则认为此图像块十分接近于此卷积核**。如果我们设计了6个卷积核，可以理解：我们认为这个图像上有6种底层纹理模式，也就是我们用6中基础模式就能描绘出一副图像。以下就是25种不同的卷积核的示例：

<img src="images/cnn/25个卷积核示意图" width="480">

总结：卷积层的通过卷积核的过滤提取出图片中局部的特征，跟上面提到的人类视觉的特征提取类似。

### 池化层（下采样）——数据降维，避免过拟合

池化层简单说就是下采样，他可以大大降低数据的维度。其过程如下：

<img src="images/cnn/池化层示意图.gif" width="480">

上图中，我们可以看到，原始图片是20×20的，我们对其进行下采样，采样窗口为10×10，最终将其下采样成为一个2×2大小的特征图。

之所以这么做的原因，是因为即使做完了卷积，图像仍然很大（因为卷积核比较小），所以为了降低数据维度，就进行下采样。

总结：池化层相比卷积层可以更有效的降低数据维度，这么做不但可以大大减少运算量，还可以有效的避免过拟合。

### 全连接层——输出结果
这个部分就是最后一步了，经过卷积层和池化层处理过的数据输入到全连接层，得到最终想要的结果。

经过卷积层和池化层降维过的数据，全连接层才能”跑得动”，不然数据量太大，计算成本高，效率低下。
<img src="images/cnn/全连接层示意图.png" width="480">

典型的 CNN 并非只是上面提到的3层结构，而是多层结构，例如 LeNet-5 的结构就如下图所示：

卷积层 – 池化层- 卷积层 – 池化层 – 卷积层 – 全连接层

<img src="images/cnn/lenet5示意图.png" width="480">

在了解了 CNN 的基本原理后，我们重点说一下 CNN 的实际应用有哪些。

## CNN 有哪些实际应用？
卷积神经网络 – CNN 很擅长处理图像。而视频是图像的叠加，所以同样擅长处理视频内容。下面给大家列一些比较成熟的应用：

### 图像分类、检索

图像分类是比较基础的应用，他可以节省大量的人工成本，将图像进行有效的分类。对于一些特定领域的图片，分类的准确率可以达到 95%+，已经算是一个可用性很高的应用了。

典型场景：图像搜索…

### 目标定位检测

可以在图像中定位目标，并确定目标的位置及大小。

典型场景：自动驾驶、安防、医疗…

### 目标分割

简单理解就是一个像素级的分类。

他可以对前景和背景进行像素级的区分、再高级一点还可以识别出目标并且对目标进行分类。

典型场景：美图秀秀、视频后期加工、图像生成…

### 人脸识别

人脸识别已经是一个非常普及的应用了，在很多领域都有广泛的应用。

典型场景：安防、金融、生活…

### 骨骼识别

骨骼识别是可以识别身体的关键骨骼，以及追踪骨骼的动作。

典型场景：安防、电影、图像视频生成、游戏…