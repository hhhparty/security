
# 汽车电器网络架构

## 大众
在MEB的平台上，大众采用了全新一代整车电子电器架构，从分布式架构（奥迪A8）直接到中央计算架构（MEB）。

MEB的中央计算架构中，有三个主要计算单元，分别叫做ICAS1、ICAS2、ICAS3.

ICAS指In Car application Server。


三域：
- ICAS1：负责车内应用系统，同时为ECU提供跨网通信能力，包括车身控制、电动系统、高压驱动、灯具系统、舒适系统等。其中，ICAS1中分为不同的网关，用于区分不同的网络，同时也为不同的局域网提供不同的安全防护，保证内部网络的数据安全。
  - Basisdienste
  - Kommouikationsserver
  - Gateway
  - Ethernet switch
- ICAS2：负责自动高级自动驾驶
  - FAS
  - Basisdienste
  - kommunikastionserver
  - Ethernet-switch
- ICAS3：负责娱乐系统等域控制器，把导航、仪表、HUB、智能座舱所有算法和硬件集中于此。
  - Basisdienste
  - MCC
  - Grafikrechner

<img src="images/汽车电器架构/大众三域.png">

## 大众 ID.4 

- ICAS1（JS33）
- ICAS3（J794）


<img src="images/汽车电器架构/大众id4.png">>


其网络架构共使用了13个子网络：
- CAN-FD EV ：主要连接DC/DC、BMC、AC充电机等，速率为2M/s
- 蓄电池CAN：用于连接电池管理单元BMC与从板CMC，速率为500k/s
- MFL-CAN：用于ICAS1 与 ESC、刹车系统 eBKV、EPS 连接，速率为2M/s
- 驱动CAN-FD：用于连接ICSA1 与驱动单元、安全气囊，速率为2M/s
- AFS-CAN：用于连接ICAS1与大灯和E-sound，速率为500k/s
- 舒适CAN：用于连接 ICAS1与座椅、天窗、车门等控制单元，速率为500k/s；
- 驾驶员辅助CAN-FD：用于连接ICAS1与ACC、PLA、RVC、MFK等，速率为2M/s；
- 100M以太网：用于ICAS1与ACC、PLA、RVC、MFK之间以及外部诊断之间的连接，速率为100M/s。
- 1G以太网：用于ICAS1与ICAS3，以及ICAS1余OCU4之间的连接，速率为1G/s。
- Con.-CAN：用于ICAS1与KESSY之间的连接。速率为500k/s。
- MIB-CAN：用于ICAS3与音响功放之间的连接，速率为500k/s。
- AB：CAN-FD：用于ICAS1与ICAS3之间，以及ICAS1余HUD、仪表、中自控、ID Light 之间的连接，速率为2M/s。

ID4中没有出现负责高级自动驾驶的ICAS2.部分自动驾驶功能在ICAS1中实现。

对于ICAS1和ICAS3，分别进行了功能分区处理，其中ICAS1的$\mu$诊断控制器分为1个区，$\mu$性能处理器分4个区，ICAS3的$\mu$性能处理器分为2个区，如下图所示：

<img src="images/汽车电器架构/icas1和icas2的功能分区.png">

其中：
ICAS1的µ诊断控制器负责最多 8 个不同 CAN 区域通信。此外，它还负责控制和协调大量功能：
- 防盗锁止系统主控制器；    - 组件保护主控制器

- 防盗报警装置；    - Kessy 自适应/ 中央门锁

- 调光；    - 疲劳识别系统

- 历史数据；    - 驾驶模式选择

- 续驶里程计算；    - 标准车外照明灯

- 离车方案；    - 显示协调器

- Time Master Base（时间周期）；    - 驻车协调器

- 低电压电源管理系统；    - 高电压电源管理系统

- 高电压充电管理；    - 接线端控制

- 可订购的功能主控制器（ FoD）

LIN 控制：

- 蓄电池数据管理；    - 车内监控/备用喇叭
- 尾灯；    - 脱手检测（ HoD）
ICAS1的µ性能处理器分4个区，具体功能如下：
1. Adaptive 系统 1 的应用程序服务器 1（8123）：
- 为 ICAS 3 的 3 个显示器的服务器/CAN 准备显示数据；
- 车辆定位（用于远程服务和功能的位置）；
- 控制充电管理服务器。充电程序，充电计时器，充电配置文件- 在线服务的消息存储器。
2. Java 系统 2 的应用程序服务器 1（8124）：
- 车载测试仪。目前在此协调控制单元的升级程序；
- 诊断服务和车辆状态数据服务器。至后端服务器网关；
- 控制车辆充电或温度调节的远程服务。
3. 嵌入式软件集群 1（ C002）：
- 个性化管理；
- 复杂车灯系统、动态车灯辅助系统、矩阵大灯控制；
- 具有备份记录和存储功能的里程计数器。为 ICAS 3 准备。
4. 软件集群内务 1（ C003）：
- 性能处理器的“ 管家”；
- 控制基础设施和 IP 路由。
ICAS3分为2个区，分别为：
1、信息娱乐系统电子装置 1（安全分区）：

- 针对中央显示屏、组合仪表（ iID）和平视显示器（ HUD）的显示控制系统，包括安全带未系警示消息、电量表、保养周期显示、消耗量；

- 控制显示语言；

- 倒车摄像头的视频解码；

- 控制 ID Light；

- 控制音频驱动程序，例如仪表板警告音，外置声音放大器；

- 车辆状态和统计数据（行程计算机）；

- 诊断服务的服务器。

2、 信息娱乐系统的系统 1 应用程序服务器 3 （车载信息娱乐系统）：

- 导航系统；

- 收音机/媒体，音频管理，智能手机集成；

- 触摸操作，语音操作；

- Connectivity, BT, WLAN， USB 接口；

- WEB – 应用程序。

以上就是对ID.4 X的总线架构以及两个中央控制单元的功能进行详细的梳理，其中图1是来源于海外版ID4的技术资料，而图2是来自上汽大众ID.4 X的技术资料，为什么在国内版本会把ICAS2给阉割掉呢，而把辅助驾驶功能集成至ICAS1中，暂时还不得而知。其它的话大致是一样的，虽然图1中并没有表明各方块代表什么控制器。