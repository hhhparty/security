# 汽车与网络安全系列 1 历史的交叉口

HHHParty 2022年5月10日

汽车就像“移动的房间”，为人们提供了出行服务的同时，还兼顾了临时居所的功能。自1885年德国人卡尔.奔驰（ BariFriedri BhAenz） 制造出第一台能用的三轮汽车以来，汽车产品和产业经过了近140年的发展，在发动机、传动系统、制动系统、车身结构、驾乘操控等方面有了诸多变化。特别是最近的50年间，汽车的电子电气架构也从分布模块，到多域集中，再向智能融合方向发展，为原有的纯机械结构加上了电，将火与电这两种神奇的力量融于一身。一台汽车上的传感器、线束、控制器、软硬件系统越来越多，功能越来越丰富，汽车从“移动的房间”逐渐演变为电气化、联网化、智能化的“移动房间”。

当汽车用户和汽车制造商不断憧憬着汽车在未来有多么美好的时候，一个从未在汽车上出现的问题出现了。这个问题就是现在汽车行业普遍关注和升温的网络安全问题。

2015年8月，Charlie Miller 博士和Chris Valasek 发表了他们的研究报告：《Remote Exploitation of an Unaltered Passenger Vehicle》。这篇长达91页的报告较为详细介绍了针对 Jeep Cherokee 2014年车型的网络安全问题研究，特别是对未改装原款车型的远程攻击部分，引起了各界人士的关注。之前对此类问题的研究，汽车OEM厂商总体态度是比较一致的，那就是这种攻击必须要物理接触车辆才能实施，这样的攻击还不如直接剪断汽车内的电线来的直接，所以没必要特别关注。而 Miller 等人的报告揭示了网络攻击不仅能远程实施，还将大面积影响众多消费者安全。至此，汽车OEM厂商、零部件T1/T2厂商不得不开始重新审视面向汽车的网络攻击，这种攻击不再只是一些技术狂热者的个人臆想，而是一种必须面对的客观存在了。

<img src="images/图2 Fiat Chrysler U.S. 2014 Jeep Grand.png" width="480">

图1 Fiat Chrysler U.S. 2014 Jeep Grand


2015年，美国国家高速公路交通安全管理局（NHTSA）根据上面报告和自身调查，发出了有史以来第一张由于网络安全而产生的召回要求。NHTSA 要求生产2014款 Jeep Cherokee（Grand）的 Fiat Chrysler 公司召回存在相关问题的车辆，包括：2013-2015款道奇蝰蛇，2013-2015款Ram 1500、2500和3500皮卡，2013-2015款Ram 3500、4500、5500 Chassis Cabs皮卡，2014-2015款Jeep大切诺基和自由光SUV，2014-2015款道奇Durango SUV，2015款克莱斯勒200、克莱斯勒300和道奇Charger轿车，2015款道奇Challenger轿跑等车型，共涉及140万辆车，所召回的车辆都搭载了基于 QNX 系统的 Uconnect 系统，配备8.4英寸大屏幕。Fiat Chrysler 公司总损失高达数百万美元。那年7月，Fiat Chrysler 公司在纽交所的股票收盘价格为15.15美元，下跌了2.5%。

<img src="images/图1 Fiat Chrysler Recall.png" width="480">  

图2 Fiat Chrysler U.S. 2014 Jeep Grand召回信息  


事实上，随着网络化、智能化程度的不断提高，汽车不可避免地融入了万物联网的世界，也自然而然会受到IoT世界中的网络安全问题的影响。这也是近年来 NHTSA、WP.29、SAE、CICV等国内外汽车研究机构开启汽车网络安全专门研究的时代背景和技术背景。在国内，随着车联网、智能网联汽车等概念的唱响，理想、蔚来、小鹏等造车新势力的崛起，华为、百度、小米、京东等互联网厂商的入局，汽车行业与互联网行业开始深度融合。国内大部分的汽车技术研究机构、汽车OEM厂商、汽车零部件供应商（T1/T2）和互联网厂商开始聚焦汽车网络安全领域，纷纷结合自身需求和特长，一方面考虑设计和实现更为成熟、更加经济的网络安全解决方案，另一方面考虑将网络安全作为新的价值增长点为内、外部客户提供相关产品和服务。

为了更好的理解和应对汽车网络安全问题，我拟定了一个目标，即编写一个涉及汽车网络安全各方面知识的系列专题。在“汽车与网络安全”这一系列专题下，将系统地分析与讨论涉及汽车网络安全的主要方面和技术细节，希望能为国内关注汽车网络安全的专业人士提供有价值的参考信息。

作为这个系列的第一篇，希望通过回顾《Remote Exploitation of an Unaltered Passenger Vehicle》这份技术报告的诸多细节来发现汽车中现实存在的网络安全问题，并形成后续的分析脉络。

<img src="images/Remote Exploitation of an Unaltered Passenger Vehicle报告.png" width="480">

图3 《Remote Exploitation of an Unaltered Passenger Vehicle》报告

《Remote Exploitation of an Unaltered Passenger Vehicle》报告主要内容包括：

- 2014款Jeep Cherokee 的技术分析
  - 网络架构
  - 网络物理特性
    - 自适应巡航控制（ACC）
    - 前向碰撞告警增强（FCW+）
    - 车道偏离告警（LDW+）
    - 泊车辅助系统（PAM）
  - 远程攻击面
    - 被动防盗窃系统（PATS）
    - 胎压监测系统（TPMS）
    - 远程无钥匙进入/启动（RKE）
    - 蓝牙
    - Radio 数据系统
    - WiFi
    - 车载信息系统/Internet/Apps
- Uconnect System
  - QNX 环境
  - 文件系统和服务
    - IFS
    - ETFS
    - MMC
    - PPS
  - WiFi
    - 加密
    - 开放端口
  - D-Bus 服务
  - 蜂窝通信模块
  - CAN 连接性
- Uconnect 越狱
  - 任意版本
  - 更新模式
  - 正常模式
- 渗透 D-Bus 服务
  - 代码执行
- Uconnect 攻击载荷
  - GPS
  - HVAC
  - Radio Volume
  - Bass
  - Radio Station（FM）
  - Display
  - Knobs
- 蜂窝通信模块渗透
  - 网络设置
  - Femtocell
  - 蜂窝通信访问
- 有漏洞车辆的扫描
  - 扫描结果
  - 有漏洞车辆数量预测
  - 车辆蠕虫
- V850
- SPI 通信
- 完整渗透链
  - 识别目标
  - 渗透车机的OMAP芯片
  - 控制 Uconnect 系统
  - v850固件刷写
  - 执行网络物理功能
- 网络物理内部结构
- 网络物理 CAN 消息
  - 正常 CAN 消息
  - 诊断 CAN 消息
- 信息披露
- 补丁和风险缓解
- 结论


