# ICV 风险评估模型
http://blog.nsfocus.net/nsfocus-security-risk-assessment-algorithms-system/


> "进忠有三术：一曰防，二曰救，三曰戒，先其未然谓之防，发而止之谓之救，行而则之谓之戒。防为上，救次之，戒为下。"——《申鉴》
> 无危则安，无损则全

国标GB/T 20984-2007中定义的信息安全风险评估规范中只给出了风险评估计算的原理和基础模型，但并没有给出从定性到定量的方法论。特别是威胁的量化，如何把威胁的严重性，威胁的热度、威胁情报的影响、威胁严重随时间因素的衰减等因素综合考虑的情况下，实现对威胁的量化。

## 单资产风险评估算法介绍

风险评估主要考虑如下因素：
- 脆弱性：反应资产漏洞情况及配置合规性情况。
- 威胁：通过以往的威胁事件对网络可能受到的威胁攻击进行预测评估。
- 资产价值：体现资产在客户网络中的重要性，依据资产在机密性、完整性和可用性上的赋值等级，经过综合评定得出。

因此在确定资产的安全风险评估算法之前，我们首先要评估出资产脆弱性、资产的威胁值及资产价值

### 脆弱性评估因素与算法
脆弱性值由主机漏洞情况及配置不符合项情况决定。其中，主机漏洞脆弱性由主机系统的所有漏洞风险加权和决定，漏洞危险程度越高的漏洞对主机漏洞脆弱性影响越大，针对漏洞的威胁程度，在绿盟的定义的漏洞库体系中给出了单个漏洞的评分系统，这个评分系统除行业标准定义的CVSS评分外。在CVSS评分不能及时跟进更新的情况下，我们还增加了绿盟自身的Nsfocus评分，作为漏洞评分系统的补充。

而对于某一主机的脆弱性评分，则是基于当前主机漏洞风险值和配置核查风险值来决定的。

主机漏洞风险值的的计算，为了最大体现威胁程度最高的漏洞对主机的威胁，我们假设一个主机共有n个漏洞，按照危险程度及CVSS评分从高到低排列的对漏洞进行排列列表为：，漏洞风险值为则依据绿盟提出的专利算法最终获得：

$r_v = a_1 + \sum_{i=2}^n(\frac{a_i^3.5}{a_1^2}*\mu)$

其中：
- $\mu$ 为收敛系数
- $\frac{a_i^3.5}{a_1^2}$ 为影响系数
- $r_v$取值范围为0～10，最小粒度0.01

。。。。


## AHP层次分析法

层次分析法，简称AHP，是指将与决策总是有关的元素分解成目标、准则、方案等层次，在此基础之上进行定性和定量分析的决策方法。该方法是美国运筹学家匹茨堡大学教授萨蒂于20世纪70年代初，在为美国国防部研究”根据各个工业部门对国家福利的贡献大小而进行电力分配”课题时，应用网络系统理论和多目标综合评价方法，提出的一种层次权重决策分析方法。

层次分析法是指将一个复杂的多目标决策问题作为一个系统，将目标分解为多个目标或准则，进而分解为多指标（或准则、约束）的若干层次，通过定性指标模糊量化方法算出层次单排序（权数）和总排序，以作为目标（多指标）、多方案优化决策的系统方法。

层次分析法是将决策问题按总目标、各层子目标、评价准则直至具体的备投方案的顺序分解为不同的层次结构，然后用求解判断矩阵特征向量的办法，求得每一层次的各元素对上一层次某元素的优先权重，最后再加权和的方法递阶归并各备择方案对总目标的最终权重，此最终权重最大者即为最优方案。

层次分析法比较适合于具有分层交错评价指标的目标系统，而且目标值又难于定量描述的决策问题。

层次分析法根据问题的性质和要达到的总目标，将问题分解为不同的组成因素，并按照因素间的相互关联影响以及隶属关系将因素按不同层次聚集组合，形成一个多层次的分析结构模型，从而最终使问题归结为最低层(供决策的方案、措施等)相对于最高层(总目标)的相对重要权值的确定或相对优劣次序的排定。

AHP分析法计算步骤主要包含如下：
- 建立层次结构模型
- 构造判定矩阵
- 一致性校验
- 计算各层权重
- 总体一致性校验

威胁值评估层次结构建模
- 目标层
  - 资产威胁值
- 准则层
  - 作用域
    - local、remote
  - 威胁维度
    - 威胁度、热度、信誉度
  - 时间区间
    - 近10天、前10～20天、前20～30天...
- 方案层
  - 基于威胁值定义
  - 威胁度值计算
  - 热度计算
  - 信誉度计算

构造分层判定矩阵

在构造判定矩阵之前，我们需要给出从定性到定量的判定准则。在层次分析法中，为了使判定定量化，关键在于设法是的任意两个方案对于某一个判定准则相对优越程度得到定量描述，一般对单一准则来说，两个方案进行比较总能判断出优劣，我们采用1~9标度的方法，对不同情况评比给出数量标度，实现定性到定量的标定。
