# 自动驾驶典型应用场景安全分析
## 辅助自动驾驶场景安全分析

通过 C-V2X 工作组、C-SAE、C-ITS 等中国标准及产业组织共同研究，面向辅助驾驶阶段定义了 17 个 C-V2X 的基础应用场景。这些应用场景基于 C-V2X 信息交互，实现车辆、道路设施、行人等交通参与者之间的实时状态共享，辅助驾驶员进行决策。

序号 类别 应用名称
1 安全 前向碰撞预警 FCW
2 安全 交叉路口碰撞预警
3 安全 左转辅助
4 安全 盲区预警 / 变道辅助
5 安全 逆向超车预警
6 安全 紧急制动预警
7 安全 异常车辆提醒
8 安全 车辆失控预警
9 安全 道路危险状况提示
10 安全 限速预警
11 安全 闯红灯预警
12 安全 弱势交通参与者碰撞预警
13 效率 绿波车速引导
14 效率 车内标牌
15 效率 前方拥堵提醒
16 效率 紧急车辆提醒
17 信息服务 汽车近场支付

### 前向碰撞预警场景

Forward Collision Warning (FCW)前方碰撞预警系统能够通过摄像头系统或雷达系统来时刻监测前方车辆，判断本车于前车之间的距离、方位及相对速度，当存在潜在碰撞危险时对驾驶者进行警告。FCW系统本身可能不采取任何制动措施去避免碰撞或控制车辆。

2017年3月7日，交通运输部组织制定了交通运输行业标准《营运客车安全技术条件》，并于2017年4月1日起正式实施，要求9米以上的营运客车要求必须具备车道偏离预警系统（LDW）和前方碰撞预警系统（FCW），并给出了13个月的过渡期。交通部此项强制要求是国内首个强制安装ADAS系统的案例，由此可见，LDW和FCW是 ADAS 的必备基础功能。

<img src="images/自动驾驶场景/车道偏离.png">

上图为：LDW - 车道偏离警告LDW 系统会在驾驶员的车辆并入另一条车道而没有激活转向信号时发出警报。

<img src="images/自动驾驶场景/前方碰撞告警.png">

上图为：FCW – 前方碰撞警告
FCW系统监控车辆和前方车辆的速度。它还监控两辆车之间的距离。一旦系统预见到即将发生的碰撞，系统就会提醒驾驶员。

<img src="images/自动驾驶场景/车头时距监测警告.png">

上图为HMW – 车头时距监测警告
当前方车辆离车辆太近时，HMW 系统会向驾驶员发出警报。

<img src="images/自动驾驶场景/行人碰撞警告.png">

上图为PCW – 行人碰撞警告
PWC 系统在检测到可能与行人发生碰撞时会向驾驶员发出警报。

<img src="images/自动驾驶场景/自动紧急制动.png">

上图为AEB – 自动紧急制动
AEB 系统检测到潜在的碰撞并在驾驶员忽略其他碰撞警告时启动紧急制动。

相关统计数据表明，由于驾驶员的主观因素导致的交通事故占比最高，若在交通事故发生前的1.5s给驾驶员发出预警，可避免90%的碰撞事故，大大减少交通事故的伤害。而汽车防碰撞安全控制系统就是通过各种传感器，比如摄像头、雷达等，实时检测车辆周围的物体，并检测目标车辆距离本车的距离。当安全距离小于阈值时，则发出警报提示驾驶员，有效降低了交通事故的发生。

其实，对汽车防碰撞系统的研究源远流长，早在20世纪70年代，日本就开始进行了汽车碰撞系统的研究，1999年，本田、丰田、日产三大车厂各自开始开发自己的前车碰撞预警系统，2003年在美版雅阁中本田首次安装了自己的碰撞缓解制动系统（CMBS），可以看做是现在FCW（Forward Collision Warning）系统的前身。CMBS系统的工作原理是：当毫米波雷达探测到前方可能有碰撞危险时，便以警告的方式提醒驾驶员，如果继续接近，当系统判断将要追尾时，则会采取自动制动措施。而日本另一大汽车厂商丰田的预碰撞安全系统最早是在2003年安装在雷克萨斯LX和RX车系上，同样也是采取了毫米波雷达作为传感器。欧美对此的研究也不落后，作为全球安全领域的领军者——沃尔沃在2006年的S80上首次安装了碰撞预警系统，通过毫米波雷达来检测车距，发现危险时会提示驾驶员立即制动，同时会推动制动片接近制动盘，以便为驾驶员制动提供最快的反应速度，2007年系统升级后，沃尔沃便增加了自动制动的功能。现在，FCW功能已经成为ADAS系统常见的标准配置。

#### 前碰撞预警系统FCW实现原理详解

首先，通过分析传感器获取的前方道路信息对前方车辆进行识别和跟踪，如果有车辆被识别出来，则对前方车距进行测量。同时利用车速估计，根据安全车距预警模型判断追尾可能，一旦存在追尾危险，便根据预警规则及时给予驾驶人主动预警。

<img src="images/自动驾驶场景/前向碰撞预警场景1.png">

可以将其分为三个部分：
- 前方车辆识别
- 前方车距检测
- 安全车距预警模型构建

##### 前方车辆识别：
- 可以采用的传感器有：单目视觉、立体视觉、毫米波雷达、多传感器融合
- 单目视觉会读图像进行识别的研究最多，知名adas公司Mileview主要采用此方法。这种方法的车辆检测一般都是依靠车辆特征信息，如车辆形状、车高与车宽的比例等作为检测车辆边缘的约束条件，对图像进行边缘增强处理后获得一些包含车辆信息的水平和垂直边缘，从而对车辆进行检测。使用单目摄像头的算法简单、计算的实时性强，但单目视觉方案容易受到光照、阴影等外界环境因素的影响，使其可靠性下降。

- 立体视觉，直接模拟人类视觉处理景物方式，通过多个视点观察同一景物，获取不同视角下的感知图像。技术尚不成熟。

- 多传感器融合，是当前研究主流，常见的有：视觉+激光雷达、视觉+毫米波雷达。除了成本高，计算较为复杂也是一个问题。

<img src="images/自动驾驶场景/前向碰撞预警场景2.png">

##### 前方车距检测

车距测量是FCW系统的重要组成部分，超声波、毫米波、激光雷达、视觉摄像头都可以实现。
- 超声波测距原理简单、成本最低，但其测距精准性受室外温度影响大，衰减快，因此目前只适合短距离测距，主要用在倒车雷达上。
- 实际应用中，常用的是毫米波雷达和视觉方案。
- 通常24GHz的毫米波雷达适于近距离探测；77GHz的毫米波雷达适于远距离探测。

- 视觉测距所需的算法比较复杂，通常有单目视觉和双目视觉两种。单目视觉采用摄像机的焦距和事先确定的参数来估算车距，而双目视觉测距是利用视差的原理，通过对两幅图像进行计算机分析和处理，确定物体的三维坐标，可采用公垂线中点法计算出距离。
- 鉴于视觉技术采集的信息量丰富，以及目前图像处理技术的巨大进步和计算能力已经能够保证图像处理实时性要求，价格低廉的视觉方案成为最理想的选择。
  
例如：对前方车辆的跟踪和测距都是动态进行的，如果前方车辆突然变道超车，FCW必须马上将跟踪车辆切换的新的目标上。

##### 安全车距预警模型

在模型设计上，马自达模型、本田模型以及伯克利模型是比较经典的安全车距模型，后续的很多模型都是在其基础上进行改良。

- 马自达模型：当发现前车减速时，开始向安全车距警报系统发送信息。当前后车辆距离低于跟随车的制动距离时，系统向制动器发出指令，跟随车开始减速，最后与前车速度均见到零时，此时两车之间距离为5米。该模型的本质是实时计算最小安全距离，从而对车速进行预警和控制。

- 本田模型：该公司研制的汽车防撞系统采用的是两次报警模型，第一次为提醒报警，第二次为制动报警。该模型的提醒报警距离的确定是先对驾驶人进行多次试验得到数据，然后通过大数据处理得到最佳安全距离。

- 伯克利模型：也采用两次报警方式，提醒报警的距离计算是沿用马自达的模型，不同的是讲前后车的制动减速取为相等的值。制动报警距离的计算采用的是非保守的方法，为了不影响驾驶人正常操作。该模型是综合考虑上面两类方法的优点，实用性有较大提高。

### 安全分析
#### 攻击面梳理
从该场景的实现情况来看，可能受到网络攻击影响的组件有：
- 传感器
- 内部通信
  - 连接超声波雷达的 LIN 或 CAN
  - 连接毫米波雷达的 CAN 或 CAN-FD
  - 连接摄像头
  - 激光雷达
    - UART串行通信
    - 以太网接口（RJ45头）例如深圳镭神智能公司的N301激光雷达S型。UDP协议
    - 法雷奥新款激光雷达系统能够以450万像素、每秒25帧的速度重建车辆周围的3D实时图像。
- 计算环境安全威胁
- 面向算法漏洞的攻击



<img src="images/自动驾驶场景/深圳镭神智能公司的N301激光雷达S型.png">






前向碰撞预警
交叉路口碰撞预警
左转辅助
盲区预警 / 变道辅助
逆向超车预警
紧急制动预警
异常车辆提醒
车辆失控预警
道路危险状况提示
限速预警
闯红灯预警
弱势交通参与者碰撞预警
绿波车速引导
车内标牌
前方拥堵提醒
紧急车辆提醒
汽车近场支付


## 自动驾驶典型应用场景及技术需求

5G 技术的更大数据吞吐量、更低时延、更高安全性和更海量连接等特性，极大地促进了智能驾驶和智慧交通发展。产业各方开始了面向自动驾驶的增强型应用场景的研究与制定，一方面从基础典型应用场景的实时状态共享过渡到车与车、车与路、车与云的协同控制，增强了信息交互复杂程度，可实现协同自动驾驶与智慧交通的应用；另一方面基于通信与计算技术的提升，交通参与者之间可以实时传输高精度视频、传感器数据，甚至是局部动态高精度地图数据，提高了感知精度与数据丰富程度。

序号 类别 应用名称
1 安全 协作式变道
2 安全 协作式匝道汇入
3 安全 协作式交叉口通行
4 安全 感知数据共享 / 车路协同感知
5 安全 道路障碍物提醒
6 安全 慢行交通轨迹识别及行为分析
7 效率 车辆编队
8 效率 协作式车队管理
9 效率 特殊车辆信号优先
10 效率 动态车道管理
11 效率 车辆路径引导
12 效率 场站进出服务
13 效率 基于实时网联数据的交通信号配时动态优化
14 效率 高速公路专用道柔性管理
15 效率 智能停车引导
16 信息服务 浮动车数据采集
17 信息服务 差分数据服务
18 信息服务 基于车路协同的主被动电子收费
19 信息服务 基于车路协同的远程软件升级


3GPP 将增强的应用场景分为 4 类，包括：车辆编队行驶、半 / 全自动驾驶、传感器信息交互和远程驾驶；

5GAA 也针对面向自动驾驶的增强应用场景进行了定义，涉及安全、效率、自动驾驶、公共服务等方面。


面向自动驾驶的增强应用场景对数据交互技术、高精度定位技术、多传感器融合技术、高性能处理平台、高精度地图等提出了新的需求。
- 在通信方面，单车上下行数据速率需求大于 10 Mbit/s，部分场景需求 50 Mbit/s，
- 时延需求为 3 ～ 50 ms，
- 可靠性需大于99.999%；
- 在信息交互方面，需实时交互车辆、道路、行人的全量数据，
- 利用多传感器融合技术获取实时动态交通高精度地图；
- 在数据处理方面，单车每天将产生高达 PB 级的数据，对数据的存储、分析等计算能力提出了更高的要求；
- 在定位方面，需达到亚米级甚至厘米级的定位精度。
