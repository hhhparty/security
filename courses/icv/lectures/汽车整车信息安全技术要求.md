# 汽车整车信息安全技术要求

## 5 安全保障要求

### 5.1 网络安全管理体系
#### 5.1.1　车辆制造商应建立车辆全生命周期的网络安全管理体系。
注1：	车辆全生命周期包括车辆的开发阶段、生产阶段及后生产阶段。
#### 5.1.2　网络安全管理体系中应建立必要流程，以确保充分考虑安全风险。
注2：	必要流程可包括：
1)	组织内部管理网络安全的流程；
2)	识别车型风险的流程；
3)	已识别风险的评估、分类和处理流程；
4)	核实已识别的风险得到适当处置的流程；
5)	测试车型网络安全的流程；
6)	确保风险评估保持最新状态的流程；
7)	监控、检测和响应针对车型的网络攻击、网络威胁和漏洞流程；
8)	用于评估所实施的网络安全措施在发现新的网络威胁和漏洞的情况下是否仍然有效的流程；
9)	针对未遂或成功的网络攻击进行分析，提供相关数据支持的流程。
#### 5.1.3　应确保已识别的网络威胁和漏洞在合理的时间框架内得到缓解。
#### 5.1.4　应在满足法规关于个人隐私（敏感信息）安全要求的条件下确保监控网络攻击、网络威胁和车辆类型漏洞的活动持续进行。
注3：	车辆自上牌后即纳入监控范围；
注4：	应具备从车辆数据和车辆日志中分析和检测网络威胁、漏洞和网络攻击的能力；
注5：	此条款应满足关于个人隐私（敏感信息）安全的相关法规要求。
#### 5.1.5　应明确网络安全管理体系与供应商、制造商子组织之间可能存在与各安全流程相关的依赖关系并进行管理。

### 5.2　车型要求 
#### 5.2.1　车型产品开发过程中,应遵循网络安全管理体系要求进行开发。
5.2.2　应识别和管理车型产品与供应商相关的风险。
5.2.3　应确认车型的关键要素，对车型进行详细的风险评估，适当处理及管理已识别的风险。
注6：	风险评估应考虑车型的各个要素及其相互作用，并进一步考虑与任何外部系统的相互作用。
5.2.4　应采取基于xxxxx技术要求章节相应的处置措施保护车型不受风险评估中已识别的风险影响。若xxxxx技术要求章节相应的处置措施与所识别的风险不相关或不充分，则车辆制造商应确保实施其它适当的处置措施，并说明其使用措施的合理性。
5.2.5　应采取适当和相应的措施，以保护车型用于存储和执行售后软件、服务、应用程序或数据的专用网络环境（若有提供）。
5.2.6　应验证所实施的安全措施的有效性。
5.2.7　应针对车型实施相应措施以监控和抵御针对该车型车辆的网络攻击，提供支持车辆制造商在检测与车型相关的威胁、漏洞和网络攻击方面的监测能力，提供数据取证能力以便分析企图（未遂）或成功的网络攻击。
5.2.8　如果所使用的密码算法或措施不符合国际通用或国家标准要求，则应说明其使用的合理性。

## 6　外部连接安全要求 
### 6.1　远控系统安全要求
#### 6.1.1　远程操控功能的系统
6.1.1.1　应对远程控制功能的指令信息进行真实性和完整性校验；
注1：	远程控制功能，指那些影响驾驶安全的远程操控功能。如远程钥匙、防盗锁等。
6.1.1.2　应具备远程控制指令信息进行真实性和完整性校验失败处理功能，限制非法重复远程控制请求次数；
6.1.1.3　应对远程控制指令的范围进行访问控制，禁止非法使用控制外的远程控制指令操控系统；
6.1.1.4　应启动安全审计功能，审计记录包括远程控制指令的日期、时间、发送主体、操作是否成功等；
6.1.1.5　应对审计记录应进行保护，避免未预期的删除、修改或覆盖等；
6.1.1.6　应对审计进程进行保护，防止未授权的中断；
6.1.1.7　应对远程操控功能的系统的程序和数据进行完整性验证

#### 6.1.2　短距离无线和传感器
6.1.2.1　应对传感器采取电磁干扰屏蔽措施；
6.1.2.2　应对短距离无线系统电磁抗干扰攻击进行检测，并报警提示。

### 6.2　第三方应用安全要求
6.2.1　应对第三方应用的真实性和完整性进行检验；
注2：	第三方应用，托管于智能网联汽车的第三方应用，如第三方娱乐应用。
6.2.2　应对第三方应用的访问资源进行访问控制，非法使用控制外的资源的应用禁止安装和运行。

### 6.3　外部接口安全要求
注3：	外部接口，包括USB接口、OBD接口和其他接口等。

6.3.1　应对USB端口接入设备中的文件进行访问控制，只允许媒体文件读写或指定签名的应用软件安装或执行；
6.3.2　应对Jtag接口、其他调试接口访问进行访问控制保护，禁止非授权用户访问；
6.3.3　应具备对USB端口接入设备中的病毒程序和携带病毒的媒体文件/应用软件的识别能力，报警并有效阻断；
6.3.4　应对通过OBD接口发送Control、Clear、Reset请求时，应采用身份鉴别、访问控制等安全策略；

## 7　通信安全技术要求
### 7.1　防止车辆接收消息或数据的欺骗
7.1.1　车辆应验证所接收消息的真实性和完整性，以防止被仿冒的消息欺骗。
注1：	车辆接收的消息类型可能是V2X（802.11p）消息、GNSS消息等。
7.1.1.1　车辆与车辆、路边单元、服务平台等的通信，应实施身份认证（删除？考虑假名证书应用）。
7.1.1.2　应采用完整性保护和校验机制，防止车辆接收的消息被篡改或伪造。
注2：	在传输数据中带有验证信息（例如采用消息认证码）的方式可实施完整性保护。
7.1.2　应对存储的密钥实施安全控制，以防止女巫（仿冒其他车辆）攻击。
7.1.2.1　车辆的身份密钥应进行安全存储。
注4：	可使用硬件安全模块存储车辆身份密钥。
7.1.2.2　密钥的使用应设置访问控制机制。
（秘钥、安全存储、访问控制考虑放在通用/一般要求）
### 7.2　防止利用通信通道执行未授权的车辆代码/数据操作
7.2.1　应采用完整性保护和校验机制，以防止通过通信通道注入篡改的代码到车辆的数据/代码中。
注5：	例如通过通信通道注入被篡改的软件二进制代码到通信流中。
7.2.2　应对车辆内部网络进行安全区域划分，并采取适宜的安全策略和措施对区域边界进行防护，对于不需要通信的物理设备之间实现逻辑上的隔离。
注6：	对于以太网，可采用VLAN技术实现不同功能域之间的逻辑隔离。

7.2.3　应采用访问控制及相关技术，防止来自外部通道的消息对车辆数据/代码的非法操纵、覆盖、清除，或非法数据代码的写入。（与PG5 要求的协调，对网关的要求）
注7：	进一步明确代码的范畴与定义？可执行的数据？
7.3　防止通信通道接收不可信或不可靠消息引起会话劫持、重放攻击
7.3.1　车辆应验证通过通信通道所接收消息的真实性，以防止接收不可靠或不可信来源的信息。
7.3.2　车辆应验证通过通信通道所接收消息的真实性，以防止遭受中间人攻击/会话劫持。

7.3.3　车辆应验证通过通信通道所接收消息的有效期或唯一性，以防止遭受重放攻击。
注8：	需验证其有效期或唯一性的消息如车辆的远程控制服务器传输的车控指令，车端通过校验该类指令的有效期或唯一性，可防止车控指令被用于重放攻击。

### 7.4　防止信息被泄露
7.4.1　向车辆传输或从车辆传送的机密数据应受到保护，通过建立相应的机密性保护措施，防止因车辆的通信信息被拦截、干扰辐射或通信监控而导致的敏感信息泄露。
注9：典型的需受到传输机密性保护的数据如重要的整车故障报警数据、车辆控制类数据、个人敏感信息等。

7.4.2　应通过访问控制及相关技术，防止对个人或系统的关键数据或文件的未经授权的访问。（与通信安全的相关性？）
注10：	安全控制的例子可在OWASP中找到。
### 7.5　防止通过通信通道破坏车辆功能的拒绝服务攻击

7.5.1　应采取措施检测拒绝服务攻击并从该类攻击中恢复，防止通过通信（包括车外通信和车内通信）通道注入大量垃圾数据到车辆信息系统中导致其不能正常提供服务。

7.5.2　应采取措施检测黑洞攻击并从该类攻击中恢复。
注11：	黑洞攻击可能用于阻止传递给其他车辆的信息，从而中断车辆之间的通信。

### 7.6　防止非特权用户获得对车辆系统的特权访问

7.6.1　应采取措施检测和防止非特权用户获得对系统的特权访问。
注12：	非特权用户可能通过调试接口获得系统的根用户权限。
（待与其他章节讨论）考虑技术要求的可实施性及管理方式解决？
7.7　防止嵌入通信媒介中的病毒感染车辆系统
7.7.1　应采取针对嵌入到通信媒介中的病毒/恶意软件的措施，以防止其感染车辆系统。
注13：	可应用识别恶意代码攻击的技术识别通过通信媒介（例如USB接口）的病毒入侵行为。
（示例与PG1有重叠，不应包括物理访问），有通道场景

### 7.8　防范车辆接收或传输的消息中的恶意内容

7.8.2　车辆应对接收的消息进行真实性和完整性校验，以识别恶意的V2X消息、恶意的诊断消息、恶意的专有消息等，并采取防护措施，防止车辆受到恶意消息的攻击。
注14：	V2X消息如道路设施发送到车辆的消息、车辆与车辆之间的消息（例如CAM, DENM）。
注15：	专有消息指正常发送自OEM或组件/系统/功能供应商的消息。

## 8　软件升级安全要求
### 8.1.1　车辆端和OTA软件升级服务器应进行身份认证，验证彼此身份的真实性。
注1：	常见的认证方式包括使用数字证书进行身份认证。
8.1.2　车辆端在进行软件升级前，应对升级包进行真实性和完整性校验。
8.1.3　车辆端软件升级程序应将OTA软件升级过程中发生的失败事件进行日志记录，并上报至服务器。
注2：	失败事件包括但不限于升级包校验失败、与升级包服务器身份认证失败。日志内容包括但不限于事件时间、事件类型。
8.1.4　车辆端软件升级节点应具备安全启动的功能，可信根、Bootloader程序及系统固件不应被篡改，或被篡改后无法正常启动。（被刷写部件是否能实现安全启动功能？）
8.2.1　车辆端应对本地刷写接入端进行身份认证，验证其身份的真实性。
注3：	常见的认证方式包括使用数字证书进行身份认证。
8.2.2　车辆端在进行本地/物理软件升级前，应对升级包进行完整性校验。
8.2.3　车辆端软件升级节点应具备安全启动的功能，可信根、Bootloader程序及系统固件不应被篡改，或被篡改后无法正常启动。（被刷写部件是否能实现安全启动功能？）





## R155/整车信息安全测试

### TARA
识别车型关键要素及其网络安全威胁，通过建模分析评估可能的风险，对中高等级威胁进行渗透型测试，尝试发现产品漏洞，以评估风险等级。
### 外部连接组件、功能的信息安全测试
  - 远程控制
    - 远程操控系统（例如：无钥匙启动、遥控钥匙、防盗锁、手机APP控制泊车等）指令的真实性、完整性是否被保护？
    - 保障远控指令真实性、完整性的机制（校验成功/失败/非法重复次数/绕过）是否存在漏洞？
    - 远控系统访问控制机制测试（是否有AAA）？
    - 远控系统审计记录是否包括远程控制指令的日期、时间、发送主体、操作是否成功等？
    - 远控系统审计记录是否被保护（是否可删除、修改、覆盖）？
    - 远控系统审计进程是否被保护（可否阻断）？
    - 远控系统程序是否存在漏洞？
    - 远控系统数据是否可被非法访问？      
  - 短距离
    - 传感器电磁干扰攻击测试（抗干扰性能）
  - 第三方应用
    - 是否可安装非法第三方应用程序（是否有签名验证、身份验证、权限验证）？
    - 阻断非法应用安装或运行的机制是否可被绕过？
    - 合法第三方应用程序是否存在漏洞？
    - 合法第三方应用程序通信数据的真实性、完整性是否被保护？
    - 合法第三方应用程序自身访问控制机制测试（是否有AAA）？
  - 外部接口
    - USB端口接入设备（如TBOX、IVI等）是否存在访问控制机制？是否对文件有读写限制？是否仅允许运行合法程序？是否可绕过？
    - Jtag端口、其他调试口接入设备，是否存在访问控制机制？是否可绕过？
    - USB端口接入设备（如TBOX、IVI等）是否存在对恶意代码、含恶意代码文件的检测能力？是否可报警？是否可阻断？
    - OBD端口是否具有访问控制机制？在发送Control、Clear、Reset请求时，是否可绕过机制保护？
### 通信安全测试
  - 利用各种可用信道（PG5、wlan、蓝牙、OBD、USB），测试车辆是否会接收非法来源对消息？是否有合法性校验（是否会误用虚假数据）？
  - 通信数据（V2X、车内网）是否存在机密性、完整性保护？消息是否可篡改？是否可执行身份欺骗？
  - 所用密码学技术是否存在漏洞？
  - 所用安全策略是否可以绕过？
  - 密钥（如车辆身份密钥）存储是否安全？是否有足够的访问控制？
  - 是否使用HSM？是否正确配置和使用？
  - 是否存在注入型漏洞？
  - 车内网络是否存在安全域划分？是否存在必要的物理隔离和逻辑隔离？
  - 是否能通过车内网络跨安全域对ECU中数据/代码的非法操纵、覆盖、清除，或非法数据代码的写入？
  - 车内、车外通信是否存在通信劫持漏洞？可否实施有效的中间人攻击？
  - 车内、车外通信（远控指令、V2X通信数据）是否存在消息重放攻击？消息是否有有效时间控制？是否有唯一性？
  - 是否可通过DDoS攻击影响车辆安全关键系统？是否存在对垃圾流量的清理？
  - 应用软件是否存在CC攻击漏洞？
  - 是否可阻断CC攻击影响和恢复系统？
  - 是否存在越权、提权攻击漏洞？
  - 是否对通信媒介含有的恶意代码有查杀功能？是否存在绕过漏洞？
  - 通信（V2X、车内网）网络中是否存在对恶意消息或行为的检测机制？
### 软件升级
  - 升级前，车端与远程服务器端是否进行双向身份认证（例如使用数字证书）？双向身份认证机制是否存在漏洞？
  - 升级前，车端是否对软件包进行签名验证？验证机制是否存在漏洞？
  - 升级前，车端是否对软件包进行完整性校验？校验机制是否存在漏洞？
  - 远程升级过程中，通信数据是否进行身份和完整性校验？
  - 远程升级过程是否存在中间人攻击漏洞？
  - 升级过程是否完整记入日志（事件的时间、主体、客体、权限、结果等）？日志是否可被篡改？可被泄露？
  - 日志是否能够上传至服务器（是否可被审计）？通信过程是否存在中间人攻击漏洞？
  - 车端升级系统（安全机制）是否可被篡改？
  - 带软件升级功能的车端组件是否有安全启动（Secure bootloader）功能？安全bootloader是否可被篡改？
  - 带软件升级功能的车端组件是否有可信根？
  - 带软件升级功能的车端组件的固件是否可被篡改（例如有无启动时完整性校验）？
  - 本地软件升级时，车端是否对刷写器进行身份认证（例如是否使用数字证书进行签名及签名验证）？认证机制是否可被篡改？
  - 使用的密码学技术是否存在已知漏洞？

### TSP
  - TSP与车端通信前，是否使用双向认证？是否有AAA访问控制机制？
  - TSP与车端通信受阻，无法为车辆提供服务时，车端是否存在降级后漏洞？
### 其他（标准里未明确分类）
- 支持用户安全第三方应用的，是否具有身份认证机制？是否可被绕过？
- 支持用户安全第三方应用的，是否具有完整性校验机制？是否可被绕过？
- 车载固件（含驱动、操作系统、中间件、应用软件）、第三方应用软件是否采用了默认安全配置（最小特权、日志、AAA、不必要端口和服务、隔离）？是否存在漏洞？
- 车辆是否外接调试设备进行身份认证？认证机制是否存在漏洞？
- 车载固件（含驱动、操作系统、中间件、应用软件）、第三方应用软件是否在启动时对自身进行完整性验证？是否可以篡改？
- 车载软件系统是否存在有漏洞的中间件、开源软件？
- 车载软件是否采用可靠的安全机制（混淆、加壳、DEP、ASLR）？

### 硬件
  - 是否存在暴露引脚、丝印
### 数据
  - 车辆是否具有个人隐私泄露问题？有无清除个人隐私功能？是否存在漏洞？
  - 车辆重要数据（车辆唯一标识、监管数据、行驶数据、测绘数据、隐私、日志、配置数据）是否可被泄露、篡改？
